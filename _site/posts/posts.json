[
  {
    "path": "posts/2021-08-29-hands-on-exercise-3/",
    "title": "Hands-on-exercise-3",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Wong Wei Ling",
        "url": "www.google.com"
      }
    ],
    "date": "2021-08-29",
    "categories": [],
    "contents": "\r\n2.0 Loading Packages\r\n Load required packages \r\n\r\npackages <- c('sf', 'tidyverse', 'tmap')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)) {\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n}\r\n\r\n\r\n\r\n3.0 Importing Data into R\r\n3.2 Importing Geospatial Data into R\r\n\r\n\r\nmpsz <- st_read(dsn = \"data/geospatial\", \r\n                layer = \"MP14_SUBZONE_WEB_PL\")\r\n\r\n\r\nReading layer `MP14_SUBZONE_WEB_PL' from data source \r\n  `C:\\wlwong2018\\IS415 Blog\\_posts\\2021-08-29-hands-on-exercise-3\\data\\geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\n\r\n\r\n\r\nmpsz\r\n\r\n\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\nFirst 10 features:\r\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND\r\n1         1          1    MARINA SOUTH    MSSZ01      Y\r\n2         2          1    PEARL'S HILL    OTSZ01      Y\r\n3         3          3       BOAT QUAY    SRSZ03      Y\r\n4         4          8  HENDERSON HILL    BMSZ08      N\r\n5         5          3         REDHILL    BMSZ03      N\r\n6         6          7  ALEXANDRA HILL    BMSZ07      N\r\n7         7          9   BUKIT HO SWEE    BMSZ09      N\r\n8         8          2     CLARKE QUAY    SRSZ02      Y\r\n9         9         13 PASIR PANJANG 1    QTSZ13      N\r\n10       10          7       QUEENSWAY    QTSZ07      N\r\n        PLN_AREA_N PLN_AREA_C       REGION_N REGION_C\r\n1     MARINA SOUTH         MS CENTRAL REGION       CR\r\n2           OUTRAM         OT CENTRAL REGION       CR\r\n3  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n4      BUKIT MERAH         BM CENTRAL REGION       CR\r\n5      BUKIT MERAH         BM CENTRAL REGION       CR\r\n6      BUKIT MERAH         BM CENTRAL REGION       CR\r\n7      BUKIT MERAH         BM CENTRAL REGION       CR\r\n8  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n9       QUEENSTOWN         QT CENTRAL REGION       CR\r\n10      QUEENSTOWN         QT CENTRAL REGION       CR\r\n            INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\r\n1  5ED7EB253F99252E 2014-12-05 31595.84 29220.19   5267.381\r\n2  8C7149B9EB32EEFC 2014-12-05 28679.06 29782.05   3506.107\r\n3  C35FEFF02B13E0E5 2014-12-05 29654.96 29974.66   1740.926\r\n4  3775D82C5DDBEFBD 2014-12-05 26782.83 29933.77   3313.625\r\n5  85D9ABEF0A40678F 2014-12-05 26201.96 30005.70   2825.594\r\n6  9D286521EF5E3B59 2014-12-05 25358.82 29991.38   4428.913\r\n7  7839A8577144EFE2 2014-12-05 27680.06 30230.86   3275.312\r\n8  48661DC0FBA09F7A 2014-12-05 29253.21 30222.86   2208.619\r\n9  1F721290C421BFAB 2014-12-05 22077.34 29893.78   6571.323\r\n10 3580D2AFFBEE914C 2014-12-05 24168.31 30104.18   3454.239\r\n   SHAPE_Area                       geometry\r\n1   1630379.3 MULTIPOLYGON (((31495.56 30...\r\n2    559816.2 MULTIPOLYGON (((29092.28 30...\r\n3    160807.5 MULTIPOLYGON (((29932.33 29...\r\n4    595428.9 MULTIPOLYGON (((27131.28 30...\r\n5    387429.4 MULTIPOLYGON (((26451.03 30...\r\n6   1030378.8 MULTIPOLYGON (((25899.7 297...\r\n7    551732.0 MULTIPOLYGON (((27746.95 30...\r\n8    290184.7 MULTIPOLYGON (((29351.26 29...\r\n9   1084792.3 MULTIPOLYGON (((20996.49 30...\r\n10   631644.3 MULTIPOLYGON (((24472.11 29...\r\n\r\n3.3 Importing Attribute Data into R\r\n\r\n\r\npopdata <- read_csv(\"data/aspatial/respopagesextod2011to2020.csv\")\r\n\r\n\r\n\r\n3.4 Data Preparation\r\n DATA WRANGLING \r\n\r\npopdata2020 <- popdata %>%\r\n  filter(Time == 2020) %>%\r\n  group_by(PA, SZ, AG) %>%\r\n  summarise(`POP` = sum(`Pop`)) %>%\r\n  ungroup()%>%\r\n  pivot_wider(names_from=AG, \r\n              values_from=POP) %>%\r\n  mutate(YOUNG = rowSums(.[3:6])\r\n         +rowSums(.[12])) %>%\r\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\r\nrowSums(.[13:15]))%>%\r\nmutate(`AGED`=rowSums(.[16:21])) %>%\r\nmutate(`TOTAL`=rowSums(.[3:21])) %>%  \r\nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\r\n/`ECONOMY ACTIVE`) %>%\r\n  select(`PA`, `SZ`, `YOUNG`, \r\n       `ECONOMY ACTIVE`, `AGED`, \r\n       `TOTAL`, `DEPENDENCY`)\r\n\r\n\r\n\r\n3.4.2 JOINING THE ATTRIBUTE DATA AND GEOSPATIAL DATA\r\n Convert the values in PA and SZ fields to uppercase \r\n\r\npopdata2020 <- popdata2020 %>%\r\n  mutate_at(.vars = vars(PA, SZ), \r\n          .funs = funs(toupper)) %>%\r\n  filter(`ECONOMY ACTIVE` > 0)\r\n\r\n\r\n\r\n Join using left_join() to ensure that the output will be a simple features data frame \r\n\r\nmpsz_pop2020 <- left_join(mpsz, popdata2020,\r\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\r\n\r\n\r\n\r\nChoropleth Mapping Geospatial Data Using tmap\r\n4.1 Plotting a choropleth map quickly by using qtm()\r\n\r\n\r\ntmap_mode(\"plot\")\r\nqtm(mpsz_pop2020, \r\n    fill = \"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\n4.2 Creating a choropleth map by using tmap’s elements\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\",\r\n          title = \"Dependency ratio\") +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1.2,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            frame = TRUE) +\r\n  tm_borders(alpha = 0.5) +\r\n  tm_compass(type=\"8star\", size = 2) +\r\n  tm_scale_bar() +\r\n  tm_grid(alpha =0.2) +\r\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \r\n             position = c(\"left\", \"bottom\"))\r\n\r\n\r\n\r\n\r\n4.2.1 DRAWING A BASE MAP\r\n\r\n\r\ntm_shape(mpsz_pop2020) +\r\n  tm_polygons()\r\n\r\n\r\n\r\n\r\n4.2.2 DRAWING A CHOROPLETH MAP USING TM_POLYGONS()\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_polygons(\"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\n4.2.3 DRAWING A CHOROPLETH MAP USING TM_FILL() AND *TM_BORDER()**\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\nAdd boundary of planning subzones The alpha argument is used to define transparency number between 0 (totally transparent) and 1 (not transparent). By default, the alpha value of the col is used (normally 1).\r\nBeside alpha argument, there are three other arguments for tm_borders(), they are: \r\n col = border colour,  lwd = border line width. The default is 1, and  lty = border line type. The default is “solid”. \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\") +\r\n  tm_borders(lwd = 0.1,  alpha = 1)\r\n\r\n\r\n\r\n\r\n4.3 Data classification methods of tmap\r\ntmap provides a total ten data classification methods, namely: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks. \r\n4.3.1 PLOTTING CHOROPLETH MAPS WITH BUILT-IN CLASSIFICATION METHODS\r\n Quantile data classification \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"quantile\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Equal data classification method \r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"equal\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Jenks data classification method \r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"jenks\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Kmeans data classification method \r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"kmeans\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Quantile data classification (input = 2) \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 2,\r\n          style = \"quantile\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Quantile data classification (input = 6) \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 6,\r\n          style = \"quantile\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Quantile data classification (input = 10) \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 10,\r\n          style = \"quantile\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Quantile data classification (input = 20) \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 20,\r\n          style = \"quantile\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n2nd DIY: The larger the number of classes, the more difficult it is to tell which area of the map belongs to which class.\r\n4.3.2 PLOTTING CHOROPLETH MAP WITH CUSTOM BREAK\r\n A good practice to get some descriptive statistics on the variable before setting the break points. Code chunk below will be used to compute and display the descriptive statistics of DEPENDENCY field. \r\n\r\nsummary(mpsz_pop2020$DEPENDENCY)\r\n\r\n\r\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \r\n 0.0000  0.6519  0.7025  0.7742  0.7645 19.0000      92 \r\n\r\n With reference to the results above, we set break point at 0.60, 0.70, 0.80, and 0.90.\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00)) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nColour Scheme\r\n4.4.1 USING COLOURBREWER PALETTE\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 6,\r\n          style = \"quantile\",\r\n          palette = \"Blues\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n Same map as above, but in green.  To reverse the colour shading, add a “-” prefix. \r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          style = \"quantile\",\r\n          palette = \"-Greens\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n4.5 Map Layouts\r\n4.5.1 MAP LEGEND\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"jenks\", \r\n          palette = \"Blues\", \r\n          legend.hist = TRUE, \r\n          legend.is.portrait = TRUE,\r\n          legend.hist.z = 0.1) +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            legend.outside = FALSE,\r\n            legend.position = c(\"right\", \"bottom\"),\r\n            frame = FALSE) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n4.5.2 MAP STYLE\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"-Greens\") +\r\n  tm_borders(alpha = 0.5) +\r\n  tmap_style(\"classic\")\r\n\r\n\r\n\r\n\r\n4.5.3 CARTOGRAPHIC FURNITURE\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\",\r\n          title = \"No. of persons\") +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1.2,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            frame = TRUE) +\r\n  tm_borders(alpha = 0.5) +\r\n  tm_compass(type=\"8star\", size = 2) +\r\n  tm_scale_bar(width = 0.15) +\r\n  tm_grid(lwd = 0.1, alpha = 0.2) +\r\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data\r\n             from Department of Statistics DOS\", \r\n             position = c(\"left\", \"bottom\"))\r\n\r\n\r\n\r\n\r\n To reset the default style \r\n\r\ntmap_style(\"white\")\r\n\r\n\r\n\r\n4.6 Drawing Small Multiple Choropleth Maps\r\nSmall multiple maps, also referred to as facet maps, are composed of many maps arrange side-by-side, and sometimes stacked vertically. Small multiple maps enable the visualisation of how spatial relationships change with respect to another variable, such as time. In tmap, small multiple maps can be plotted in three ways:\r\nby assigning multiple values to at least one of the asthetic arguments,\r\nby defining a group-by variable in tm_facets(), and\r\nby creating multiple stand-alone maps with tmap_arrange().\r\n\r\n4.6.1 BY ASSIGNING MULTIPLE VALUES TO AT LEAST ONE OF THE AESTHETIC ARGUMENTS\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(c(\"YOUNG\", \"AGED\"),\r\n          style = \"equal\", \r\n          palette = \"Blues\") +\r\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\r\n  tm_borders(alpha = 0.5) +\r\n  tmap_style(\"white\")\r\n\r\n\r\n\r\n\r\n Assigning multiple values to at least one of the aesthetic arguments \r\n\r\ntm_shape(mpsz_pop2020)+ \r\n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\r\n          style = c(\"equal\", \"quantile\"), \r\n          palette = list(\"Blues\",\"Greens\")) +\r\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\r\n\r\n\r\n\r\n\r\n4.6.2 BY DEFINING A GROUP-BY VARIABLE IN TM_FACETS()\r\n\r\n\r\ntm_shape(mpsz_pop2020) +\r\n  tm_fill(\"DEPENDENCY\",\r\n          style = \"quantile\",\r\n          palette = \"Blues\",\r\n          thres.poly = 0) + \r\n  tm_facets(by=\"REGION_N\", \r\n            free.coords=TRUE, \r\n            drop.shapes=TRUE) +\r\n  tm_layout(legend.show = FALSE,\r\n            title.position = c(\"center\", \"center\"), \r\n            title.size = 20) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n4.6.3 BY CREATING MULTIPLE STAND-ALONE MAPS WITH TMAP_ARRANGE()\r\n\r\n\r\nyoungmap <- tm_shape(mpsz_pop2020)+ \r\n  tm_polygons(\"YOUNG\", \r\n              style = \"quantile\", \r\n              palette = \"Blues\")\r\n\r\nagedmap <- tm_shape(mpsz_pop2020)+ \r\n  tm_polygons(\"AGED\", \r\n              style = \"quantile\", \r\n              palette = \"Blues\")\r\n\r\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\r\n\r\n\r\n\r\n\r\n4.7 Mappping Spatial Object Meeting a Selection Criterion\r\n\r\n\r\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\", \r\n          legend.hist = TRUE, \r\n          legend.is.portrait = TRUE,\r\n          legend.hist.z = 0.1) +\r\n  tm_layout(legend.outside = TRUE,\r\n            legend.height = 0.45, \r\n            legend.width = 5.0,\r\n            legend.position = c(\"right\", \"bottom\"),\r\n            frame = FALSE) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-29-hands-on-exercise-3/hands-on-exercise-3_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2021-08-29T20:15:13+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-23-in-class-exercise-2/",
    "title": "In-class Exercise 2",
    "description": "In this hands-on exercise, I learnt how to handle geospatial data in R by using sf package.",
    "author": [
      {
        "name": "Wong Wei Ling",
        "url": "www.google.com"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\nGetting Started\r\nThis code chunk performs 3 tasks:  * Create a list of R packages needed.\r\n\r\n\r\npackages <- c('sf', 'tidyverse')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)) {\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n}\r\n\r\n\r\n\r\nTest\r\n\r\n[1] \"test\"\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-23T11:52:04+08:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to My Blog",
    "description": "Welcome to our new blog, My Blog. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Wong Wei Ling",
        "url": "www.google.com"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-23T09:41:53+08:00",
    "input_file": {}
  }
]
