<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Take-Home Exercise 2</title>

  <meta property="description" itemprop="description" content="To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-09-30"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-09-30"/>
  <meta name="article:author" content="Wong Wei Ling"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Take-Home Exercise 2"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Take-Home Exercise 2"/>
  <meta property="twitter:description" content="To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Take-Home Exercise 2"]},{"type":"character","attributes":{},"value":["To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Wong Wei Ling"]},{"type":"character","attributes":{},"value":["www.google.com"]}]}]},{"type":"character","attributes":{},"value":["09-30-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float","number_sections"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/aspatial/hotels.csv","data/aspatial/listings_June_2019.csv","data/aspatial/listings_June_2021.csv","data/aspatial/tourism.csv","data/geospatial/CostalOutline.dbf","data/geospatial/CostalOutline.prj","data/geospatial/CostalOutline.sbn","data/geospatial/CostalOutline.sbx","data/geospatial/CostalOutline.shp","data/geospatial/CostalOutline.shx","data/geospatial/MP14_SUBZONE_WEB_PL.dbf","data/geospatial/MP14_SUBZONE_WEB_PL.prj","data/geospatial/MP14_SUBZONE_WEB_PL.sbn","data/geospatial/MP14_SUBZONE_WEB_PL.sbx","data/geospatial/MP14_SUBZONE_WEB_PL.shp","data/geospatial/MP14_SUBZONE_WEB_PL.shp.xml","data/geospatial/MP14_SUBZONE_WEB_PL.shx","data/geospatial/MRTLRTStnPtt.CPG","data/geospatial/MRTLRTStnPtt.dbf","data/geospatial/MRTLRTStnPtt.prj","data/geospatial/MRTLRTStnPtt.sbn","data/geospatial/MRTLRTStnPtt.sbx","data/geospatial/MRTLRTStnPtt.shp","data/geospatial/MRTLRTStnPtt.shx","take-home-exercise-2_files/anchor-4.2.2/anchor.min.js","take-home-exercise-2_files/bowser-1.9.3/bowser.min.js","take-home-exercise-2_files/distill-2.2.21/template.v2.js","take-home-exercise-2_files/figure-html5/unnamed-chunk-13-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-14-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-22-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-23-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-25-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-35-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-39-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-41-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-45-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-7-1.png","take-home-exercise-2_files/header-attrs-2.10/header-attrs.js","take-home-exercise-2_files/htmlwidgets-1.5.3/htmlwidgets.js","take-home-exercise-2_files/jquery-1.11.3/jquery.min.js","take-home-exercise-2_files/jquery-1.12.4/jquery.min.js","take-home-exercise-2_files/leaflet-1.3.1/images/layers-2x.png","take-home-exercise-2_files/leaflet-1.3.1/images/layers.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-icon-2x.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-icon.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-shadow.png","take-home-exercise-2_files/leaflet-1.3.1/leaflet.css","take-home-exercise-2_files/leaflet-1.3.1/leaflet.js","take-home-exercise-2_files/leaflet-binding-2.0.4.1/leaflet.js","take-home-exercise-2_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js","take-home-exercise-2_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js","take-home-exercise-2_files/leafletfix-1.0.0/leafletfix.css","take-home-exercise-2_files/popper-2.6.0/popper.min.js","take-home-exercise-2_files/proj4-2.6.2/proj4.min.js","take-home-exercise-2_files/Proj4Leaflet-1.0.1/proj4leaflet.js","take-home-exercise-2_files/rstudio_leaflet-1.3.1/images/1px.png","take-home-exercise-2_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css","take-home-exercise-2_files/tippy-6.2.7/tippy-bundle.umd.min.js","take-home-exercise-2_files/tippy-6.2.7/tippy-light-border.css","take-home-exercise-2_files/tippy-6.2.7/tippy.css","take-home-exercise-2_files/tippy-6.2.7/tippy.umd.min.js","take-home-exercise-2_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="take-home-exercise-2_files/header-attrs-2.10/header-attrs.js"></script>
  <script src="take-home-exercise-2_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="take-home-exercise-2_files/jquery-1.12.4/jquery.min.js"></script>
  <link href="take-home-exercise-2_files/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
  <script src="take-home-exercise-2_files/leaflet-1.3.1/leaflet.js"></script>
  <link href="take-home-exercise-2_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
  <script src="take-home-exercise-2_files/proj4-2.6.2/proj4.min.js"></script>
  <script src="take-home-exercise-2_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
  <link href="take-home-exercise-2_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
  <script src="take-home-exercise-2_files/leaflet-binding-2.0.4.1/leaflet.js"></script>
  <script src="take-home-exercise-2_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
  <script src="take-home-exercise-2_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
  <script src="take-home-exercise-2_files/popper-2.6.0/popper.min.js"></script>
  <link href="take-home-exercise-2_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="take-home-exercise-2_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="take-home-exercise-2_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="take-home-exercise-2_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="take-home-exercise-2_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="take-home-exercise-2_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="take-home-exercise-2_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Take-Home Exercise 2","description":"To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore.","authors":[{"author":"Wong Wei Ling","authorURL":"www.google.com","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-09-30T00:00:00.000+08:00","citationText":"Ling, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Take-Home Exercise 2</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>To investigate if the distribution of Airbnb listings are affected by location factors and to analyse the impact of COVID-19 on Airbnb business in Singapore.</p></p>
</div>

<div class="d-byline">
  Wong Wei Ling www.google.com 
  
<br/>09-30-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#objectives">1 Objectives</a></li>
<li><a href="#dataset">2 Dataset</a></li>
<li><a href="#install-and-load-packages">3 Install and Load Packages</a></li>
<li><a href="#data-import-and-preparation-for-geospatial-dataset">4 Data Import and Preparation for Geospatial Dataset</a>
<ul>
<li><a href="#import-geospatial-data-set">4.1 Import geospatial data set</a></li>
<li><a href="#check-crs">4.2 Check CRS</a></li>
<li><a href="#assign-crs-and-check-again">4.3 Assign CRS and check again</a></li>
<li><a href="#check-if-geometries-are-valid">4.4 Check if geometries are valid</a></li>
<li><a href="#handle-the-invalid-geometries-and-check-again">4.5 Handle the invalid geometries and check again</a></li>
<li><a href="#visualise-the-mrt-services-on-the-singapore-map">4.6 Visualise the MRT services on the Singapore map</a></li>
</ul></li>
<li><a href="#data-import-and-preparation-for-aspatial-dataset">5 Data Import and Preparation for Aspatial Dataset</a>
<ul>
<li><a href="#import-aspatial-data-sets">5.1 Import aspatial data sets</a></li>
<li><a href="#look-into-the-data-sets">5.2 Look into the data sets</a></li>
<li><a href="#data-cleaning">5.3 Data Cleaning</a></li>
<li><a href="#convert-aspatial-data-frame-into-sf-object-and-assign-crs">5.4 Convert Aspatial data frame into sf object and assign CRS</a></li>
<li><a href="#check-crs-1">5.5 Check CRS</a></li>
<li><a href="#plot-to-review-including-geospatial-data-excluding-listings_2021">5.6 Plot to review (including geospatial data, excluding listings_2021)</a></li>
<li><a href="#plot-to-review-including-geospatial-data-excluding-listings_2019">5.7 Plot to review (including geospatial data, excluding listings_2019)</a></li>
</ul></li>
<li><a href="#geospatial-data-wrangling">6 Geospatial Data Wrangling</a>
<ul>
<li><a href="#convert-sf-to-spatial-classes">6.1 Convert sf to Spatial* classes</a></li>
<li><a href="#convert-spatial-dataframe-into-spatial-objects">6.2 Convert Spatial* dataframe into Spatial* objects</a></li>
<li><a href="#convert-from-spatial-objects-into-ppp-object">6.3 Convert from Spatial* objects into ppp object</a></li>
<li><a href="#summary-statistics-of-the-newly-created-ppp-objects">6.4 Summary statistics of the newly created ppp objects</a></li>
<li><a href="#find-number-of-duplicated-points">6.5 Find number of duplicated points</a></li>
<li><a href="#handle-duplicated-points-using-jitter">6.6 Handle duplicated points using jitter</a></li>
<li><a href="#create-an-owin-object">6.7 Create an owin object</a></li>
<li><a href="#combine-with-owin-object">6.8 Combine with owin object</a></li>
<li><a href="#visualise-the-ppp-objects">6.9 Visualise the ppp objects</a></li>
<li><a href="#re-scale-kde-values">6.10 Re-scale KDE Values</a></li>
</ul></li>
<li><a href="#section-a-airbnb-distribution-in-2019">7 Section A: Airbnb Distribution in 2019</a>
<ul>
<li><a href="#exploratory-spatial-data-analysis">7.1 Exploratory Spatial Data Analysis</a>
<ul>
<li><a href="#kernel-density-estimation">7.1.1 Kernel Density Estimation</a></li>
</ul></li>
<li><a href="#second-order-spatial-point-patterns-analysis">7.2 Second Order Spatial Point Patterns Analysis</a>
<ul>
<li><a href="#prepare-and-visualise-subzones">7.2.1 Prepare and visualise subzones</a></li>
<li><a href="#extract-selected-study-areas">7.2.2 Extract selected study areas</a></li>
<li><a href="#multi-type-point-patterns-analysis-cross-l-function">7.2.3 Multi-type Point Patterns Analysis: Cross L-Function</a></li>
</ul></li>
</ul></li>
<li><a href="#section-b-impact-of-covid-19">8 Section B: Impact of COVID-19</a>
<ul>
<li><a href="#exploratory-spatial-data-analysis-1">8.1 Exploratory Spatial Data Analysis</a>
<ul>
<li><a href="#kernel-density-estimation-1">8.1.1 Kernel Density Estimation</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="objectives">1 Objectives</h1>
<ul>
<li>To investigate if the distribution of Airbnb listings are affected by location factors such as near to existing hotels, MRT services and tourist attractions.</li>
<li>To analyse the impact of COVID-19 on Airbnb business in Singapore by comparing Airbnb listings data on June 2019 and June 2021</li>
</ul>
<h1 id="dataset">2 Dataset</h1>
<ul>
<li>Airbnb listings for June 2019 and June 2021 from Inside Airbnb.</li>
<li>Hotels, tourist attractions, MRT services and other appropriate geospatial data sets were supposed to be extracted from SLA OneMap Service by using onemapsgapi. However, due to some issues of creating a onemap account, Prof. Kam has kindly provided us with the data in CSV format.</li>
<li>Coastaloutline is used for binding the Singapore boundary which is also provided by Prof. Kam.</li>
<li>Sub zones from data.gov.sg</li>
</ul>
<h1 id="install-and-load-packages">3 Install and Load Packages</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'tidyverse'</span>, <span class='st'>'sf'</span>, <span class='st'>'tmap'</span>, <span class='st'>'maptools'</span>, <span class='st'>'spatstat'</span>, <span class='st'>'raster'</span>, <span class='st'>'gridExtra'</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
<span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Explanation on the uses of each package:</p>
<ul>
<li><p><strong>tidyverse</strong>: For data import and tidying. It also consist of several other packages specified below.</p>
<ul>
<li><strong>readr</strong>: For importing CSV files</li>
<li><strong>dplyr</strong>: For data manipulation</li>
<li><strong>ggplot2</strong>: For plotting graphics</li>
</ul></li>
<li><p><strong>sf:</strong> For importing and processing of geospatial data such as encoding spatial vector data.</p></li>
<li><p><strong>tmap:</strong> For plotting interactive maps</p></li>
<li><p><strong>maptools:</strong> For maanipulating geospatial data</p></li>
<li><p><strong>spatstat:</strong> For statistical analysis of spatial data.</p></li>
<li><p><strong>raster:</strong> For processing geospatial data to plot KDE maps on OpenStreetMap</p></li>
<li><p><strong>gridExtra:</strong> For arranging KDE maps when plotted into grid objects</p></li>
</ul>
<h1 id="data-import-and-preparation-for-geospatial-dataset">4 Data Import and Preparation for Geospatial Dataset</h1>
<p>In this section, we have to import and ensure that the geospatial data is a format that we can use to perform analysis. We have to check if it is being assigned the right CRS and code. Also, since we are working in the boundary of Singapore, we have to ensure that it is in SVY21 as well.</p>
<h2 id="import-geospatial-data-set">4.1 Import geospatial data set</h2>
<ul>
<li><em>st_read()</em> of <strong>sf</strong> package to import the geospatial data sets.</li>
<li>The imported shapefile will be a simple feature Object of sf.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mrt_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>, layer <span class='op'>=</span> <span class='st'>"MRTLRTStnPtt"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `MRTLRTStnPtt&#39; from data source 
  `C:\wlwong2018\IS415 Blog\_posts\2021-09-30-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 185 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6138.311 ymin: 27555.06 xmax: 45254.86 ymax: 47854.2
Projected CRS: SVY21</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>, layer <span class='op'>=</span> <span class='st'>"MP14_SUBZONE_WEB_PL"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `MP14_SUBZONE_WEB_PL&#39; from data source 
  `C:\wlwong2018\IS415 Blog\_posts\2021-09-30-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sg_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>, layer<span class='op'>=</span><span class='st'>"CostalOutline"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `CostalOutline&#39; from data source 
  `C:\wlwong2018\IS415 Blog\_posts\2021-09-30-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 60 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 2663.926 ymin: 16357.98 xmax: 56047.79 ymax: 50244.03
Projected CRS: SVY21</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>The geometry type is point, multipolygon and polygon for the mrt, mpsz and sg data set.</li>
<li>The assigned CRS for all is SVY21.</li>
</ul>
<h2 id="check-crs">4.2 Check CRS</h2>
<ul>
<li>Check CRS using <em>st_crs()</em> of <strong>sf</strong> package.</li>
<li>Singapore is using SVY21.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>Referencing from <em>(<a href="https://epsg.io/3414" class="uri">https://epsg.io/3414</a>)</em>, the EPSG code of SVY21 is supposed to be 3414.</li>
<li>The EPSG code shown is 9001 which is incorrect.</li>
</ul>
<h2 id="assign-crs-and-check-again">4.3 Assign CRS and check again</h2>
<ul>
<li><em>st_set_crs()</em> of <strong>sf</strong> package to assign correct EPSG code to SpatialPointsDataFrame.</li>
<li>Do not have to use <em>st_transform()</em> since it is already in SVY21.</li>
<li><em>st_crs</em> of <strong>sf</strong> package to check the CRS again.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mrt_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>mrt_sf</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>mpsz_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>mpsz_sf</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>sg_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>sg_sf</span>, <span class='fl'>3414</span><span class='op'>)</span>

<span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
</div>
<h2 id="check-if-geometries-are-valid">4.4 Check if geometries are valid</h2>
<ul>
<li><em>st_is_valid()</em> is used to check for any invalid geometries.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 9</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>There are 0, 9 and 1 invalid geometries for mrt, mpsz and sg respectively</li>
</ul>
<h2 id="handle-the-invalid-geometries-and-check-again">4.5 Handle the invalid geometries and check again</h2>
<ul>
<li><em>st_make_valid()</em> to make the geometries valid for the mpsz and sg data set only since MRT has no invalid geometries</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_make_valid</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span>
<span class='va'>sg_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_make_valid</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
</div>
<p>Result above show that:</p>
<ul>
<li>There are no longer any invalid geometries</li>
</ul>
<h2 id="visualise-the-mrt-services-on-the-singapore-map">4.6 Visualise the MRT services on the Singapore map</h2>
<ul>
<li>It is a good practice to visualise the geospatial data before continuing with the other steps.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<h1 id="data-import-and-preparation-for-aspatial-dataset">5 Data Import and Preparation for Aspatial Dataset</h1>
<p>For aspatial data, we have to check for NA values because if NA values are not properly handled, it might hinder with the analysis in the later steps. Additionally, we have to convert them to sf objects and assign them the right CRS, making these data sets suitable to be plotted on a map.</p>
<h2 id="import-aspatial-data-sets">5.1 Import aspatial data sets</h2>
<ul>
<li><em>read_csv()</em> of <strong>readr</strong> package to import the aspatial data sets.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/listings_June_2019.csv"</span><span class='op'>)</span>
<span class='va'>hotels</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/hotels.csv"</span><span class='op'>)</span>
<span class='va'>tourism</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/tourism.csv"</span><span class='op'>)</span>
<span class='va'>listings_2021</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/listings_June_2021.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="look-into-the-data-sets">5.2 Look into the data sets</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>listings_2019</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 8,293
Columns: 16
$ id                             &lt;dbl&gt; 49091, 50646, 56334, 71609, 7~
$ name                           &lt;chr&gt; &quot;COZICOMFORT LONG TERM STAY R~
$ host_id                        &lt;dbl&gt; 266763, 227796, 266763, 36704~
$ host_name                      &lt;chr&gt; &quot;Francesca&quot;, &quot;Sujatha&quot;, &quot;Fran~
$ neighbourhood_group            &lt;chr&gt; &quot;North Region&quot;, &quot;Central Regi~
$ neighbourhood                  &lt;chr&gt; &quot;Woodlands&quot;, &quot;Bukit Timah&quot;, &quot;~
$ latitude                       &lt;dbl&gt; 1.44255, 1.33235, 1.44246, 1.~
$ longitude                      &lt;dbl&gt; 103.7958, 103.7852, 103.7967,~
$ room_type                      &lt;chr&gt; &quot;Private room&quot;, &quot;Private room~
$ price                          &lt;dbl&gt; 81, 80, 68, 200, 92, 102, 203~
$ minimum_nights                 &lt;dbl&gt; 180, 90, 6, 1, 1, 1, 1, 7, 30~
$ number_of_reviews              &lt;dbl&gt; 1, 18, 20, 12, 20, 35, 23, 15~
$ last_review                    &lt;date&gt; 2013-10-21, 2014-12-26, 2015~
$ reviews_per_month              &lt;dbl&gt; 0.01, 0.28, 0.21, 0.13, 0.21,~
$ calculated_host_listings_count &lt;dbl&gt; 2, 1, 2, 9, 9, 9, 9, 1, 4, 4,~
$ availability_365               &lt;dbl&gt; 365, 365, 365, 353, 353, 348,~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>hotels</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 422
Columns: 9
$ NAME              &lt;chr&gt; &quot;Jayleen Clarke Quay Hotel&quot;, &quot;JEN Singapor~
$ ADDRESSPOSTALCODE &lt;dbl&gt; 59390, 238858, 249716, 399041, 238485, 399~
$ ADDRESSSTREETNAME &lt;chr&gt; &quot;25 New Bridge Road&quot;, &quot;277 Orchard Road , ~
$ HYPERLINK         &lt;chr&gt; &quot;jayleenclarkequay@gmail.com&quot;, &quot;singaporeo~
$ TOTALROOMS        &lt;dbl&gt; 20, 499, 565, 42, 81, 33, 17, 634, 56, 451~
$ KEEPERNAME        &lt;chr&gt; &quot;James Federick Chong Kah Yean&quot;, &quot;Kuok Oon~
$ Lat               &lt;dbl&gt; 1.288715, 1.300510, 1.304271, 1.311586, 1.~
$ Lng               &lt;dbl&gt; 103.8475, 103.8392, 103.8239, 103.8775, 10~
$ ICON_NAME         &lt;chr&gt; &quot;hotel.gif&quot;, &quot;hotel.gif&quot;, &quot;hotel.gif&quot;, &quot;ho~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>tourism</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 107
Columns: 17
$ NAME              &lt;chr&gt; &quot;Chinatown Heritage Centre, Singapore&quot;, &quot;T~
$ DESCRIPTION       &lt;chr&gt; &quot;Experience how Singapore’s early Chinese ~
$ ADDRESSSTREETNAME &lt;chr&gt; &quot;48 Pagoda Street&quot;, &quot;158 Telok Ayer Street~
$ HYPERLINK         &lt;chr&gt; &quot;http://www.singaporechinatown.com.sg/&quot;, &quot;~
$ PHOTOURL          &lt;chr&gt; &quot;www.yoursingapore.com/content/dam/desktop~
$ URL_PATH          &lt;chr&gt; &quot;www.yoursingapore.com/en/see-do-singapore~
$ IMAGE_ALT_TEXT    &lt;chr&gt; &quot;Learn more about local Chinese culture at~
$ PHOTOCREDITS      &lt;chr&gt; &quot;Joel Chua DY&quot;, &quot;Joel Chua DY&quot;, &quot;Joel Chua~
$ LASTMODIFIED      &lt;dttm&gt; 2015-11-02 02:16:52, 2015-11-02 02:20:57,~
$ LATITUDE          &lt;dbl&gt; 1.283510, 1.280940, 1.310070, 1.277219, 1.~
$ LONGTITUDE        &lt;dbl&gt; 103.8444, 103.8476, 103.8994, 103.8373, 10~
$ META_DESCRIPTION  &lt;chr&gt; &quot;At the Chinatown Heritage Centre, experie~
$ OPENING_HOURS     &lt;chr&gt; &quot;Daily, 9am – 8pm,Last entry at 7pm.*China~
$ Lat               &lt;dbl&gt; 1.283510, 1.280940, 1.310070, 1.277219, 1.~
$ Lng               &lt;dbl&gt; 103.8444, 103.8476, 103.8994, 103.8373, 10~
$ ICON_NAME         &lt;chr&gt; &quot;tourist_spot.gif&quot;, &quot;tourist_spot.gif&quot;, &quot;t~
$ ADDRESSPOSTALCODE &lt;dbl&gt; NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA,~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>listings_2021</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 4,238
Columns: 16
$ id                             &lt;dbl&gt; 49091, 50646, 56334, 71609, 7~
$ name                           &lt;chr&gt; &quot;COZICOMFORT LONG TERM STAY R~
$ host_id                        &lt;dbl&gt; 266763, 227796, 266763, 36704~
$ host_name                      &lt;chr&gt; &quot;Francesca&quot;, &quot;Sujatha&quot;, &quot;Fran~
$ neighbourhood_group            &lt;chr&gt; &quot;North Region&quot;, &quot;Central Regi~
$ neighbourhood                  &lt;chr&gt; &quot;Woodlands&quot;, &quot;Bukit Timah&quot;, &quot;~
$ latitude                       &lt;dbl&gt; 1.44129, 1.33432, 1.44041, 1.~
$ longitude                      &lt;dbl&gt; 103.7957, 103.7852, 103.7967,~
$ room_type                      &lt;chr&gt; &quot;Private room&quot;, &quot;Private room~
$ price                          &lt;dbl&gt; 81, 80, 67, 177, 81, 81, 52, ~
$ minimum_nights                 &lt;dbl&gt; 180, 90, 6, 90, 90, 90, 14, 1~
$ number_of_reviews              &lt;dbl&gt; 1, 18, 20, 20, 24, 48, 20, 13~
$ last_review                    &lt;date&gt; 2013-10-21, 2014-07-08, 2015~
$ reviews_per_month              &lt;dbl&gt; 0.01, 0.22, 0.16, 0.29, 0.34,~
$ calculated_host_listings_count &lt;dbl&gt; 2, 1, 2, 4, 4, 4, 50, 50, 7, ~
$ availability_365               &lt;dbl&gt; 365, 365, 365, 365, 365, 365,~</code></pre>
</div>
<h2 id="data-cleaning">5.3 Data Cleaning</h2>
<ul>
<li>Remove NA values only from latitude and longitude columns as those are needed for analysis in the later steps.</li>
<li>NA values in other columns do not have to be dropped as the <em>data</em> will be dropped later when converting Spatial* data frame into Spatial* objects.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019</span> <span class='op'>&lt;-</span> <span class='va'>listings_2019</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>latitude</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>longitude</span><span class='op'>)</span>

<span class='va'>hotels</span> <span class='op'>&lt;-</span> <span class='va'>hotels</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>Lat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>Lng</span><span class='op'>)</span>

<span class='va'>tourism</span> <span class='op'>&lt;-</span> <span class='va'>tourism</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>LATITUDE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>LONGTITUDE</span><span class='op'>)</span>

<span class='va'>listings_2021</span> <span class='op'>&lt;-</span> <span class='va'>listings_2021</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>latitude</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>longitude</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="convert-aspatial-data-frame-into-sf-object-and-assign-crs">5.4 Convert Aspatial data frame into sf object and assign CRS</h2>
<ul>
<li>The values in the latitude &amp; longitude columns are in decimal degrees, hence, this means that it is using WGS84.</li>
<li>We then need to assign the epsg code of 4326 before transforming to SVY21.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>listings_2019</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"longitude"</span>, <span class='st'>"latitude"</span><span class='op'>)</span>,
                    crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>


<span class='va'>hotels_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hotels</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lng"</span>, <span class='st'>"Lat"</span><span class='op'>)</span>,
                    crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>


<span class='va'>tourism_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>tourism</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGTITUDE"</span>, <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                    crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>listings_2021_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>listings_2021</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"longitude"</span>, <span class='st'>"latitude"</span><span class='op'>)</span>,
                    crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="check-crs-1">5.5 Check CRS</h2>
<ul>
<li>Check CRS to ensure that it is EPSG:3414 - SVY21</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>listings_2019_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>listings_2021_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
</div>
<p>Results above show that:</p>
<ul>
<li>All are in the right code of 3414.</li>
</ul>
<h2 id="plot-to-review-including-geospatial-data-excluding-listings_2021">5.6 Plot to review (including geospatial data, excluding listings_2021)</h2>
<ul>
<li>Plot all the point events of Airbnb listings 2019, hotels, tourist attractions and MRT services to ensure that they are being assigned the right CRS.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>listings_2019_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"blue"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"red"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"green"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"orange"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<h2 id="plot-to-review-including-geospatial-data-excluding-listings_2019">5.7 Plot to review (including geospatial data, excluding listings_2019)</h2>
<ul>
<li>Plot all the point events of Airbnb listings 2021, hotels, tourist attractions and MRT services to ensure that it is being assigned the right CRS.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>listings_2021_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"blue"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"red"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"green"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
          col <span class='op'>=</span> <span class='st'>"orange"</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<h1 id="geospatial-data-wrangling">6 Geospatial Data Wrangling</h1>
<p>This section focuses on converting simple feature data frames to ppp objects that are suitable for the analysis in the later steps.</p>
<h2 id="convert-sf-to-spatial-classes">6.1 Convert sf to Spatial* classes</h2>
<ul>
<li><em>as_Spatial()</em> of <strong>sf</strong> package is being used to convert the geospatial data from simple feature data frame to sp’s Spatial* class.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span>
<span class='va'>sg</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span>
<span class='va'>listings_2019</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>listings_2019_sf</span><span class='op'>)</span>
<span class='va'>hotels</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span>
<span class='va'>tourism</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span>
<span class='va'>mrt</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>mrt_sf</span><span class='op'>)</span>
<span class='va'>listings_2021</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>listings_2021_sf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="convert-spatial-dataframe-into-spatial-objects">6.2 Convert Spatial* dataframe into Spatial* objects</h2>
<ul>
<li>As <em>spatstat</em> requires the analytical data in ppp object and there is no direct way to convert a Spatial* class to ppp object, we have to convert the Spatial classes* into Spatial object first.</li>
<li><em>as()</em> with the argument <em>SpatialPoints</em> of <strong>maptools</strong> package is being used for point data sets, while <em>SpatialPolygons</em> is being used for polygonal data sets.</li>
<li>Data would be dropped in this step.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>mpsz</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>sg_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sg</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>listings_2019_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listings_2019</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>hotels_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>hotels</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>tourisms_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>tourism</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>mrt_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>mrt</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>listings_2021_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listings_2021</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="convert-from-spatial-objects-into-ppp-object">6.3 Convert from Spatial* objects into ppp object</h2>
<ul>
<li><em>as()</em> with the argument of <em>ppp</em> of <strong>maptools</strong> package is being used.</li>
<li>Project information would be dropped in this step.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listings_2019_sp</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>hotels_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>hotels_sp</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>tourisms_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>tourisms_sp</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>mrt_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>mrt_sp</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listings_2021_sp</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="summary-statistics-of-the-newly-created-ppp-objects">6.4 Summary statistics of the newly created ppp objects</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  8293 points
Average intensity 9.345289e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [7215.57, 44098.31] x [25166.35, 49226.35] units
                    (36880 x 24060 units)
Window area = 887399000 square units</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  422 points
Average intensity 5.58414e-07 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [5939.24, 45334.18] x [25379.44, 44562.4] units
                    (39390 x 19180 units)
Window area = 755712000 square units</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>tourisms_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  106 points
Average intensity 1.328016e-07 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [11380.23, 43659.54] x [22869.34, 47596.73] units
                    (32280 x 24730 units)
Window area = 798183000 square units</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mrt_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  185 points
Average intensity 2.32988e-07 points per square unit

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [6138.31, 45254.86] x [27555.06, 47854.2] units
                    (39120 x 20300 units)
Window area = 794032000 square units</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  4238 points
Average intensity 5.114513e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [7406.99, 43337.89] x [25330, 48391.55] units
                    (35930 x 23060 units)
Window area = 828622000 square units</code></pre>
</div>
<ul>
<li><p>From the results above,</p>
<ul>
<li>Messages about duplicates are printed for listings_2019, hotels &amp; tourism.</li>
<li>The statistical methodology used for spatial point patterns processes is based largely on the assumption that process are simple, that is, that the points cannot be coincident.</li>
</ul></li>
</ul>
<h2 id="find-number-of-duplicated-points">6.5 Find number of duplicated points</h2>
<ul>
<li>sum() and multiplicity() to know the number of locations with more than 1 point event.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>listings_2019_ppp</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 10</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>tourisms_ppp</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 7</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>mrt_ppp</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>listings_2021_ppp</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 224</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>All data sets have duplicated points except for the MRT data set.</li>
</ul>
<h2 id="handle-duplicated-points-using-jitter">6.6 Handle duplicated points using jitter</h2>
<ul>
<li><em>rjitter()</em> of <strong>spatstat</strong> package is being used</li>
<li>To avoid points overlapping, rjitter() will add a small perturbation to the duplicated points so that they do not occupy the exact same space</li>
<li><em>any()</em> and <em>duplicated()</em> are used to ensure that there are no duplicated points after using <em>rjitter()</em></li>
<li>From the previous step, even though <em>mrt_ppp</em> object is being shown that there are 0 duplicated points, it is a good practice to verify by printing it again.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp_jit</span> <span class='op'>&lt;-</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels_ppp_jit</span> <span class='op'>&lt;-</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>hotels_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>hotels_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourisms_ppp_jit</span> <span class='op'>&lt;-</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>tourisms_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>tourisms_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mrt_ppp_jit</span> <span class='op'>&lt;-</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>mrt_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>mrt_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2021_ppp_jit</span> <span class='op'>&lt;-</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>listings_2021_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<ul>
<li>Results above show that all are FALSE, thereby confirming that there are no duplicated points present after performing <em>rjitter()</em>.</li>
</ul>
<h2 id="create-an-owin-object">6.7 Create an owin object</h2>
<ul>
<li><p>It is a good practice to confine the spatial point patterns analysis with a geographical area such as the Singapore boundary.</p></li>
<li><p>In <strong>spatstat</strong> package, this polygonal region is known as <strong>owin</strong>, an object specially designed to represent this boundary.</p></li>
<li><p>Convert <em>sg</em> SpatialPolygon object to owin object of <strong>spatstat</strong> package</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sg_owin</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sg_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="combine-with-owin-object">6.8 Combine with owin object</h2>
<ul>
<li>Combine point, polygonal event object and owin object into one ppp object for Airbnb listings in 2019, 2021, tourisms, hotels and MRT services.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp</span> <span class='op'>=</span> <span class='va'>listings_2019_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
<span class='va'>tourisms_ppp</span> <span class='op'>=</span> <span class='va'>tourisms_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
<span class='va'>hotels_ppp</span> <span class='op'>=</span> <span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
<span class='va'>mrt_ppp</span> <span class='op'>=</span> <span class='va'>mrt_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
<span class='va'>listings_2021_ppp</span> <span class='op'>=</span> <span class='va'>listings_2021_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<h2 id="visualise-the-ppp-objects">6.9 Visualise the ppp objects</h2>
<ul>
<li><em>plot()</em> is being used to visualise the ppp objects which are confined within Singapore boundary</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tourisms_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mrt_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<h2 id="re-scale-kde-values">6.10 Re-scale KDE Values</h2>
<ul>
<li>For the analysis in the later steps, kernel density estimation (KDE) will be computed.</li>
<li>However, since the default unit of measurement of SVY21 is in metre, we have to convert the KDE values to kilometre so that the values would not be too small to look for useful insights.</li>
<li><em>rescale()</em> is used to convert the KDE values from metre to kilometre.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>hotels_ppp.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>hotels_ppp</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>tourisms_ppp.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>tourisms_ppp</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>mrt_ppp.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>mrt_ppp</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2021_ppp</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="section-a-airbnb-distribution-in-2019">7 Section A: Airbnb Distribution in 2019</h1>
<p>This section is to investigate if the distribution of Airbnb listings are affected by location factors such as near to existing hotels, MRT services and tourist attractions. For the purpose of this analysis, Airbnb listings in June 2019 are used. To determine the objective, we will first compute and plot <strong>Kernel Density Estimation maps</strong> then confirm the insights found by using <strong>Second-Order Spatial Point Patterns Analysis</strong> to draw statistical conclusions.</p>
<h2 id="exploratory-spatial-data-analysis">7.1 Exploratory Spatial Data Analysis</h2>
<p>In this section, we will describe the way in which the expected value of the spatial point patterns varies across space such as the intensity of the spatial point patterns. There are a few ways to measure this property such as Kernel Density Estimation, Nearest Neighbours Index and Quadrat Analysis. For the purpose of this analysis however, we will just be implementing <strong>Kernel Density Estimation</strong>.</p>
<h3 id="kernel-density-estimation">7.1.1 Kernel Density Estimation</h3>
<p>Kernel Density Estimation is a method to compute the intensity of a point distribution and looks at attribute values across X, Y coordinates (value of attribute value). Geographically, X and Y is the location, which is in projected coordinates system.</p>
<h4 id="plot-kde-maps-using-automatic-bandwidth-method-ppl">7.1.1.1 Plot KDE maps using automatic bandwidth method (ppl)</h4>
<ul>
<li><p><em>density()</em> of *spatstat** package is used to plot the re-scaled data set and plot the KDE map</p></li>
<li><p>Bandwidth Selection:</p>
<ul>
<li>Baddeley et. (2016) suggested the use of the bw.ppl() algorithm because in their experience, it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters.</li>
<li>From the ppp objects plotted above, since there are tight clusters, using ppl would be the most suitable choice.</li>
</ul></li>
<li><p>Smoothing Kernel:</p>
<ul>
<li>Gaussian is the default and it will be used.</li>
<li>It uses a kernel (filter window/moving window) to remove edges and noise from the given data set, such that point events that are located further away will be given less weight.</li>
</ul></li>
<li><p>Edge argument:</p>
<ul>
<li>This is a logical value to indicate whether to apply edge correction.</li>
<li>The default is FALSE.</li>
</ul></li>
</ul>
<h5 id="bw.ppl"><em>bw.ppl</em></h5>
<ul>
<li>A function is created to plot KDE maps using the bandwidth <em>bw.ppl()</em></li>
<li>par() is used to arrange the maps in a side-by-side manner</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_ppl</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>data</span>,
    sigma<span class='op'>=</span><span class='va'>bw.ppl</span>,
    edge<span class='op'>=</span><span class='cn'>TRUE</span>,
    kernel<span class='op'>=</span><span class='st'>"gaussian"</span><span class='op'>)</span> 
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>listings_2019_ppp.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"listings 2019 bw.ppl"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>hotels_ppp.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"hotels bw.ppl"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>tourisms_ppp.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"tourism bw.ppl"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>mrt_ppp.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"mrt bw.ppl"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-25-1.png" width="960" /></p>
</div>
<p>Results above show that:</p>
<ul>
<li>There is a concentrated area for Hotels and Tourism and a few concentrated areas for MRT services.</li>
<li>Listings are generally less concentrated in the same area.</li>
</ul>
<h5 id="reveal-density">Reveal density</h5>
<ul>
<li><em>intensity()</em> of <strong>spatstat</strong> package is used to reveal the density of Airbnb listings in 2019, Hotels, Tourist Attractions and MRT services.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='va'>listings_2019_ppp.km</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 11.07325</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='va'>hotels_ppp.km</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.5622771</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='va'>tourisms_ppp.km</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.1388998</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='va'>mrt_ppp.km</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.2470814</code></pre>
</div>
<p>Results above show that:</p>
<ul>
<li>Airbnb listings in 2019 have the highest density of 11.07 units per km square, followed by hotels, tourism then MRT services which have a density of 0.56, 0.24 and 0.25 units per km square.</li>
</ul>
<h4 id="data-preparation-for-visualising-kernel-density-maps-on-openstreetmap-of-singapore">7.1.1.2 Data Preparation for visualising Kernel Density Maps on openstreetmap of Singapore</h4>
<ul>
<li>Kernel density calculates the density of point features around each output raster cell. The steps below show the deriving of kernel density maps being plotted on openstreetmap of Singapore.</li>
</ul>
<h5 id="compute-kde-maps-with-metres-instead-of-kilometers">7.1.1.2.1 Compute KDE maps with metres instead of kilometers</h5>
<ul>
<li>Since OpenStreetMap’s default units is in metres, we have to compute the KDE in metres, instead of using the previously calculated KDE in kilometres.</li>
<li>Compute KDE with bw.ppl() using metres.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_listings_2019_ppl_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>, sigma<span class='op'>=</span><span class='va'>bw.ppl</span>, edge<span class='op'>=</span><span class='cn'>TRUE</span>,kernel<span class='op'>=</span><span class='st'>"gaussian"</span><span class='op'>)</span> 
<span class='va'>kde_hotels_ppl_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>hotels_ppp</span>, sigma<span class='op'>=</span><span class='va'>bw.ppl</span>, edge<span class='op'>=</span><span class='cn'>TRUE</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span><span class='op'>)</span>
<span class='va'>kde_tourism_ppl_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>tourisms_ppp</span>, sigma<span class='op'>=</span><span class='va'>bw.ppl</span>, edge<span class='op'>=</span><span class='cn'>TRUE</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span><span class='op'>)</span>
<span class='va'>kde_mrt_ppl_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>mrt_ppp</span>, sigma<span class='op'>=</span><span class='va'>bw.ppl</span>, edge<span class='op'>=</span><span class='cn'>TRUE</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="convert-kde-output-into-grid-object">7.1.1.2.2 Convert KDE output into grid object</h5>
<ul>
<li><em>as.SpatialGridDataFrame.im()</em> is used so that the gridded output is suitable for mapping.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_listings_2019_ppl</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_listings_2019_ppl_m</span><span class='op'>)</span>
<span class='va'>gridded_kde_hotels_ppl</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_hotels_ppl_m</span><span class='op'>)</span>
<span class='va'>gridded_kde_tourism_ppl</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_tourism_ppl_m</span><span class='op'>)</span>
<span class='va'>gridded_kde_mrt_ppl</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_mrt_ppl_m</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ul>
<li>Distribution above will be the same, only legend will be different it is being plotted in meters instead of kilometers.</li>
</ul>
<h5 id="convert-gridded-output-into-raster">7.1.1.2.3 Convert gridded output into raster</h5>
<ul>
<li>Use <em>raster()</em> of <strong>raster</strong> package to convert the gridded kernel density objects to RasterLayer object.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_listings_2019_ppl_raster</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_listings_2019_ppl</span><span class='op'>)</span>
<span class='va'>kde_listings_2019_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -8.607272e-20, 0.0008461072  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_hotels_ppl_raster</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_hotels_ppl</span><span class='op'>)</span>
<span class='va'>kde_hotels_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -4.68666e-22, 1.784205e-05  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_tourism_ppl_raster</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_tourism_ppl</span><span class='op'>)</span>
<span class='va'>kde_tourism_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : 3.376166e-23, 3.144157e-06  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_mrt_ppl_raster</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_mrt_ppl</span><span class='op'>)</span>
<span class='va'>kde_mrt_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -1.127277e-22, 2.217116e-06  (min, max)</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>CRS for all data sets are NA. Hence, we have to assign appropriate projection systems.</li>
</ul>
<h5 id="assign-projection-systems">7.1.1.2.4 Assign projection systems</h5>
<ul>
<li>Assign the epsg code of 3414</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_listings_2019_ppl_raster</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_listings_2019_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -8.607272e-20, 0.0008461072  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_hotels_ppl_raster</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_hotels_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -4.68666e-22, 1.784205e-05  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_tourism_ppl_raster</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_tourism_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : 3.376166e-23, 3.144157e-06  (min, max)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_mrt_ppl_raster</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_mrt_ppl_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -1.127277e-22, 2.217116e-06  (min, max)</code></pre>
</div>
<p>From the results above:</p>
<ul>
<li>CRS for all data sets are have been assigned appropriate projection systems.</li>
</ul>
<h4 id="visualise-output-in-openstreetmap">7.1.1.3 Visualise output in openstreetmap</h4>
<ul>
<li>Create function for plotting the visualisation on OpenStreetMap</li>
<li>Use <strong>tmap</strong> package to display raster in OpenStreetMap of Singapore.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>oms</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data1</span>, <span class='va'>data2</span>, <span class='va'>legend1</span>, <span class='va'>legend2</span>, <span class='va'>main_title</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>'view'</span><span class='op'>)</span>

  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>data1</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, title <span class='op'>=</span> <span class='va'>legend1</span>, alpha<span class='op'>=</span> <span class='fl'>0.5</span>,  palette <span class='op'>=</span> <span class='st'>'Reds'</span> <span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>data2</span><span class='op'>)</span> <span class='op'>+</span> 
      <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, title <span class='op'>=</span> <span class='va'>legend2</span>, alpha<span class='op'>=</span> <span class='fl'>0.45</span>, palette <span class='op'>=</span> <span class='st'>'Blues'</span> <span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h5 id="plot-airbnb-listings-2019-against-hotels">7.1.1.3.1 Plot Airbnb Listings 2019 against Hotels</h5>
<ul>
<li>tm_basemap() to specify the visualization to be in OpenStreetMap</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>oms</span><span class='op'>(</span><span class='va'>kde_hotels_ppl_raster</span>, <span class='va'>kde_listings_2019_ppl_raster</span>, <span class='st'>"Hotels"</span>, <span class='st'>"Airbnb Listings 2019"</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-21bb8c2199859ecc07b5" style="width:624px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-21bb8c2199859ecc07b5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFSklEQVR4nO2dP1bcMBCHx2Epcg3SpuAEFBSUOQMn2eNwAMoUPB4noEgbLpLwNpVevFpZGlkz0kj6fR0Pry3Ln0d/LS0EiIjo8+P9tPW/q5vbpWZaZgOZS9sCruX7/Hg/QUYdps7UWPRLASHlmDIjS+TzgYzlfGmdgNpICghkmOot1hIQ0bAMs5kn1RCoGfkg4z5MZVpKmNyH3KrohYx5mKkTSgsDAfvBhIRcYaSP06L19Xuj6Vsr8bD8DuXS80mAaJhHs8yyIowGkDCPJsXxyAISjX9/KXLvv9obO9ODCUVCjD1vo54pM8lHdCkgZ3JELu6co0itehOzCei4urldOPe+R6LQeXuX0UQXzWjU7kr6/Hg/ab/wmueHhJXYila+QO5vyYcudT4tEVEcNyTVx+mK9ZjAqfNLVQs066EqEkI+WVIPvjS/W9cpIWEncEXZk/fDSQgBZfGL1NKo2Fq4EKIJgoA6cD+4Wv+vp66cQ+sEgDRruXJEsiqdDyJhh/QiFxf0E3bIaC87ImHHSH7u0DK6IhJ2jOTISssAgobJBFgvocRCsPUbnYGteYwS59Gkq+96QR1qS4g6IbigdmCBhCBITRGLwi6K4nGpWSQXf+cA5kFLTBTHgI2pmdWIgnMjHREhIShCQsgulloDtpCOhKgTguawJUQUBFogEoIsNLppICFoDiQEzYGEgE3TERM0SoAmiISAheaEBkzvB1FqzKZhr8YE0pzenomIaLn70TglMtSazgUJC3HipehNzNhyIv4xpUDCAnwB//x8ISKi64d71u97F1NKws06IeSLsxbQyRf6mytkTbiLZ9aC3TCxlvBWbEW/LXKjozQl0Wrrt9J1xazWMaeeIE1P8v96+U1ERN/vv7GOP709qxXJKVFSW100/8aEs/eGxBK1scUfU2vttWArCjr51vgihiJhqYCjrM61u5+wJEL5C4K78/hSjrILkmRRPEJ++JjorI5tw2UlCvrEoiCHnCg4onhrsiT0m+Z7JMldcXSrmLYqJ9F5UVxSDI8un+NCwr1SSayRzDmeI3FLQZ2Avnwp8WYRLsSuCQwp4a5ubhfJBRx75PB4XA6Px4VoW0CXTzMLSBSIhFpFXawLINQwCR1nnbMo+PQaPban+9Jm13ZVjr0bvOSso7f3YWm8SLFRkjVfn16TXVmQ8D9nkVD6waXOxxmD5HTThCRv1Xi5frinvw/3J1cEj9TVpIXKpNbYWso1OqBb1S9DLWEImIa1S7kjZzfI2G+3iueSHSlriMedNeM3RCBhnAOR7ObPNX+3Zqv4lRxqXO5+nIlocYZMj2QttC21MHcOuRsMOkr2CeYQmsx6eDwunHouOMfEsF2KPQ809huJ6OhHRc51QZhqEqbqfa1asznXTU1/IjrKJWwisia17r2IP5pSY6pYDpxqRqhaYG2qWa9svtnSw27pKLLvutKE8sBqWkch2DrWyFxOhd3aQ/XTjIinQ3DsuHYiLMkXqi6UlBAgTdPWsdUHGqu39j7JwiIXmV2SodITH6xgdZ/gUbgYO0a9B9RGdALDqFGh1ve3s9L90nDryC25E7qPLxwElIPVcZyLduU91ZGscU2gR/eRMLclC+xRRULpiOR/IGQl4kH6fWxKqFm/0iAkoouSte7DysvQGyp1wllZf5iP/OPTxXxCy6BBVM7B+pIaPQDpymDNo6uXHNugmNXBXIbiJZgPUw+4tJEUWt8wdh5ENhuY6ayuvfoDsIMZCVtFJMjanqGKoth0fBS7AIA56G2oEQAA0iCyzYGZ1rEP5APNgYQAAAAAAAAAAACYh3+/YLBfebKJqwAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","data1"]},{"method":"addLegend","args":[{"colors":["#FDDED0","#FCA082","#F75A40","#CB181D"],"labels":["0.000000 to 0.000005","0.000005 to 0.000010","0.000010 to 0.000015","0.000015 to 0.000020"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"Hotels","extra":null,"layerId":"legend401","className":"info legend data1","group":"data1"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFXElEQVR4nO2dvU4cMRSFvYiCggoJOpSGhqcgr5anSJM3yAukJHWqVFGkbQjdRtpqCzpSREaDxz/X9r329fh8EhKwsx6Pfeb4394ZYIwx5vn48hr67PbqYtcyLrOBxDVhAS7F93x8eYUYZZg6UWPulwKC5GPKhKwRnwvEWM9Z7wi0hlOAgIep3mIpAcIN61CbeFwNgZbOBzGWoSrRUoLJzeReRS/EmIeaOiG3YCDAcVAhQqpguK+Tovf9R6PrW8uRWW6Hcm14HMAN8+iWWFoEIwFEmEeX4njLAjRm+8+XIvf5m72xM2WMzwkx9hxGPFFmEp8xawFSJkfkYsPciqhFH2I2AVpury52lGcvEZEv3NHFqKKLZmu07kp6Pr68Sr/wkuFDhI0IuZUrIPs3Z6ZzhSclRBTHHUn1cdpiPSbgVPhc1QLJeqiICCE+XlIZX5veveuUEOEgUIVSkvabEyEEyItbpNa6Ym/B+WCNEAQoA3XB1fKzkbpyzntHAKRZiitHSFpF5wInHJBRxEUF/YQDsrWXHU44MJzLHXq6K5xwYDhHVnoaCBomE6C9hGKzYO0POgOheYwc4Ugy1Lpe0IbWIkSdEKxobSwQIfDSUohVtouieLu0LJKr1zmAeZASJopjQEbVzGq44NxwOyJECKrgEOQQW60BXXA7IeqEoDtkEcIFgRRwQpCFRDcNRAi6AxGC7kCEgEzXERM0SoAkcEJAQnJCA0RYyf5w6h0FUW6vLnbSM2rIuzEBP64I724uO8WEn1bTubDQiYHHp6MxxpiPH646x4SP2HYi7jW1wAkZ2LIbLnGFySXCoBNCfPlYRwyJcCnWx6fjyjlbiZe6eWYryMWxtohr5Puvv8aY/8WyK6gvP/68u+7h/rpJnGrcKvTdrrNoWrSUfPdseb8S7m4uzd3N5ZuwrCNa9oeT+fz159vfD/fXb0Jd/nCSyiv7eei67mtMKGdvcGxRG9v8MbXXnhaWRawV0v5wWonK979aRnhBKRS3jmuKZ3dDcBuOK0qNpyBZ0VHqfUu4BKgtPThQ0UUTO4ZLswtaUg2SWrYovCXFRxNQr419N3VfjeJ0i1/J7pmti8+ycsJSUXHskUy5nrJtroRA3Todt/vNIjgfxbs4xXaAKj2zjSsjWrhkqqHRcsRhdFZOKFXUxYpaX8PEd50mYi1hClqfqwfFs2hCgqHskedew50hrTI41BKGwPJ454TcDpgKj1J8U4ppn8glHH3pevvDyXz69ts83F+vnHCEriZNiMwnjO2l3KIDWipsV2x25GN/OAVdEQJMQzql3JJzGmTsu6HiueZEyh5dNqmOawtEGOfMmP7n4XLcPzbYLjXm7Y4RgzKyumi4NubOIfeAQUvNOcGlLOMK96OjYtguRUmGpmaQ2N+5BQnx5dNsoRNlalGruJTeNzX9CZSRNam19CbL78a6TiQdKga1b9OtFoww1WwEgq1jznPTfOFRhNgDXxpojetWODeGNnulFkqFXVumunGG48ngHTtuHQlN4vNVF2pKCJCma+tYa4bG6q0jTbIYhVVi1yRozTQwzWA6liyrLhrUe0BrWPsJt+oKrdbfzsrwu3ItnZvzJHQX6TmQM0PqOM5FuvKe6kiWuCeQY3gnzG3JAn00EaHE9P3lsJkWx4PoywiKULJ+JUFoP5WWz6HlZRgNkTrhrCwX5iP96Awxn1AzaBDVcz7Kfi+agejqyF4jPDMoZmVQl6B4CeZDVQbXNpJ8i85j4cDZdKCms7r17g9AD2pE2MuRINb+bKooik3HR7ELAJiD0YYaAQAgDZxtDtS0jl0gPtAdiBAAAAAAAAAAAADz8A/a3KzkVZoCpAAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.447058823529412,null,"tmap402","data2"]},{"method":"addLegend","args":[{"colors":["#E3EEF8","#BFD8EC","#7FB9DA","#4090C5","#1664AB"],"labels":["0.0000 to 0.0002","0.0002 to 0.0004","0.0004 to 0.0006","0.0006 to 0.0008","0.0008 to 0.0010"],"na_color":null,"na_label":"NA","opacity":0.447058823529412,"position":"topright","type":"unknown","title":"Airbnb Listings 2019","extra":null,"layerId":"legend402","className":"info legend data2","group":"data2"}]},{"method":"addLayersControl","args":[[],["data1","data2"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Spatial patterns revealed by the kernel density map above:</strong></p>
<ul>
<li>Shades of blue represent Airbnb listings in 2019 while shades of red represent Hotels.</li>
<li>The shades of the colours shows the number of Airbnb listings and hotels on the map.</li>
<li>It is observed that the dark blue colour is prominent in the Southern-Eastern region of Singapore, which indicates a higher number of Airbnb listings in this region.</li>
<li>From the intensity of the colours of the blue spots, it can be seen that many Airbnb listings are cluttered in the South-East region.</li>
<li>It can also be observed that there is a larger red spot in the same region. This also means that hotels are also dense in the South-East region of Singapore.</li>
</ul>
<h5 id="plot-airbnb-listings-2019-against-tourist-attractions">7.1.1.3.2 Plot Airbnb Listings 2019 against Tourist Attractions</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>oms</span><span class='op'>(</span><span class='va'>kde_tourism_ppl_raster</span>, <span class='va'>kde_listings_2019_ppl_raster</span>, <span class='st'>"Tourism"</span>, <span class='st'>"Airbnb Listings 2019"</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-6679ba314489555457aa" style="width:624px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6679ba314489555457aa">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAF/0lEQVR4nO2dy2ocRxSGTw+TRUCbAUE2EWRjYUiENiYikAfw3i/gd/Dei+z9Dn6B7PMAghCTjZANwd4YlE1AoI3ACxl1FkmPS9V1OVV16tb9fyCwNJ6anp5v/rp29UCAiIjur69G22Obw6Oh5LGsDZxcsguoynd/fTVCxjys+qS60s8HhJRjlScyRT4dyJjOpvYBlEZSQCDDqr7FuQREGqbR7MmT6giUTD7IGEdTJ80nTOiHXKvqhYxhNNMmlBYGAvZDExJyhZH+f7mo/fq9UfVbK/Fh6QPKqeVJgDQMo9rJakWYHEDCMKpUx0sWkGj5789H6Psv9o1d0wdjSkLMPdvJflLWJB/RXEDO4ohQpjKXInXWN7E2ASc2h0cD573HSGQqt3cZmxiiWRqlh5Lur6/G3F/4nOVDwkLY0koXaPpd8kOXKi+XiKiOK+Ib45yqdZfAvvKlmgU526FZJIR8svg++NTzXbtNCQk7gStKzLlfnIQQUBa9Sk1NxdrCmRA9IAiYB+4FV+pjPQ3lbGsfAPCjyhUiUqvS6SAJO6QXubhgnLBDlvZlRxJ2jOTlDjXTFUnYMZIzKzUDBB2TFdB6DSUWwa2/0TVgW8coUU5OurquF5ShtIRoE4IZpYMFEgIjJUVMil1UxculZJWcfJ0DWA+5xER1DNg0tbIaKbhupBMREoIkJITsYqs10BbSSYg2IagOW0KkIMgFkhAEkWOYBhKC6kBCUB1ICNhUnTFBpwTkBEkIWORc0IDl/cBJidU07N2YwPootZwLSZjA/cd31sc2331f8EjkcW0nov+fVJCEgbjEs9G7kBO6mFISWpMQ8s0xCvj2zcPff/jR+LyWRORunlkKdnXc2oGXhiWg+jeDjDVISSvbc4utJ9SFq3X7rlbkn0loEtCEImPJNEzdIqT6NSace29IbFHr2vzRt9deSfYCauKNlxfW5wwnp19+0VJRSsal7M4V3TtOSSh9Q/CpHF3K2ndBcnVCJgFv/3g/e+zg7Hj/+HBy+p+8QtXzUsRTaWKIxnUbrtopqKOmn0nA6e8HZ8fWMkI7KksUTyVo2k7fBSrm5ITuOLo5PBrUn9jXDSWkDfjXh5v9j85eWm4bUkF9z0smagMd7sY7tU5ganraesKmFDSJR0T0+NGOiGifiMPJqbNtuAbZbERVx6a2mlp1xt6zrdkPwpJiNgGJiHbnlwMR0Q3RuK+ateGbZt9vYWYS5mqHcYZ8WkhT34yIqR14cftp/+/Tg69Zr7N98hQC/k/0Ui6bMJyq2pSiscdhIiqJP76LmpLTubj9RD/98zcEC+BBEkonoK88TvXNqaZNknMT3SleRGeCiOj3b77dv+7u/HK4Ozset89fQkwLWRa1uvZSLjEAzb7Vq0Dy+bj5+WT86tWvENBBUMck5G6Qrue67mjpK9N0DKbnukRMkW/qZKhtQ247EJjZEsne/Lnk81RsEuec8378aOfsIQMeQeOEUhtzhxB6g8EJV1vy85+/+Y/Z0B7U54r1nvLu/HKY2oPonPDpQsKc5VuFtHRKXCJOY4MgjGJzx74OSa154u2Tp8NMRIuAeg/37sWz8eDs2DqHDHiwk811e1Pfi5iWaXH/T61Zhc+vf3lwjNvnLwf1b6qQdy+ejURE6AXHYZVD8r5ppvJCZS+FSTRdSP1xkIaxd5xDBE6y1RZQZ5LPJyNIY9ZOixWB254ztQ1blc8E0k+eqhK2Jp/KAxFdq6LfvoGYicx6pClihIrYC65xRayGSWc2d9zacnqwfEQXMPSWcFxsaYcUlKH7reHU5Ja8E7qOLhwElMM6SyHdNpRMSVM7toVV2SCO7pOQuwQMtEsRCXMs3y99CSgH1uocMMO7aCD2yrnUMmJwVdOtiAoMTI15/af2cfXIlIRIxDCa2AakZ0zCoeccxrbF/V56A9KlEXyN8Jppfb67V5o7ofgSrI+mPuDUgXPT/oaucpBsbdDMYHXp3R9AOzQjYa/byIF0FlUV6QPTLa/eBgCAPGC2BwCwPJBs66CZ3rEO5APVgYQAAAAAAAAAAABYD/8Cj5UhE0CncdEAAAAASUVORK5CYII=",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","data1"]},{"method":"addLegend","args":[{"colors":["#FEECE3","#FCCCB8","#FCA082","#FB7353","#EF3C2D","#C7171C","#980B13"],"labels":["0.0000000 to 0.0000005","0.0000005 to 0.0000010","0.0000010 to 0.0000015","0.0000015 to 0.0000020","0.0000020 to 0.0000025","0.0000025 to 0.0000030","0.0000030 to 0.0000035"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"Tourism","extra":null,"layerId":"legend401","className":"info legend data1","group":"data1"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFXElEQVR4nO2dvU4cMRSFvYiCggoJOpSGhqcgr5anSJM3yAukJHWqVFGkbQjdRtpqCzpSREaDxz/X9r329fh8EhKwsx6Pfeb4394ZYIwx5vn48hr67PbqYtcyLrOBxDVhAS7F93x8eYUYZZg6UWPulwKC5GPKhKwRnwvEWM9Z7wi0hlOAgIep3mIpAcIN61CbeFwNgZbOBzGWoSrRUoLJzeReRS/EmIeaOiG3YCDAcVAhQqpguK+Tovf9R6PrW8uRWW6Hcm14HMAN8+iWWFoEIwFEmEeX4njLAjRm+8+XIvf5m72xM2WMzwkx9hxGPFFmEp8xawFSJkfkYsPciqhFH2I2AVpury52lGcvEZEv3NHFqKKLZmu07kp6Pr68Sr/wkuFDhI0IuZUrIPs3Z6ZzhSclRBTHHUn1cdpiPSbgVPhc1QLJeqiICCE+XlIZX5veveuUEOEgUIVSkvabEyEEyItbpNa6Ym/B+WCNEAQoA3XB1fKzkbpyzntHAKRZiitHSFpF5wInHJBRxEUF/YQDsrWXHU44MJzLHXq6K5xwYDhHVnoaCBomE6C9hGKzYO0POgOheYwc4Ugy1Lpe0IbWIkSdEKxobSwQIfDSUohVtouieLu0LJKr1zmAeZASJopjQEbVzGq44NxwOyJECKrgEOQQW60BXXA7IeqEoDtkEcIFgRRwQpCFRDcNRAi6AxGC7kCEgEzXERM0SoAkcEJAQnJCA0RYyf5w6h0FUW6vLnbSM2rIuzEBP64I724uO8WEn1bTubDQiYHHp6MxxpiPH646x4SP2HYi7jW1wAkZ2LIbLnGFySXCoBNCfPlYRwyJcCnWx6fjyjlbiZe6eWYryMWxtohr5Puvv8aY/8WyK6gvP/68u+7h/rpJnGrcKvTdrrNoWrSUfPdseb8S7m4uzd3N5ZuwrCNa9oeT+fz159vfD/fXb0Jd/nCSyiv7eei67mtMKGdvcGxRG9v8MbXXnhaWRawV0v5wWonK979aRnhBKRS3jmuKZ3dDcBuOK0qNpyBZ0VHqfUu4BKgtPThQ0UUTO4ZLswtaUg2SWrYovCXFRxNQr419N3VfjeJ0i1/J7pmti8+ycsJSUXHskUy5nrJtroRA3Todt/vNIjgfxbs4xXaAKj2zjSsjWrhkqqHRcsRhdFZOKFXUxYpaX8PEd50mYi1hClqfqwfFs2hCgqHskedew50hrTI41BKGwPJ454TcDpgKj1J8U4ppn8glHH3pevvDyXz69ts83F+vnHCEriZNiMwnjO2l3KIDWipsV2x25GN/OAVdEQJMQzql3JJzGmTsu6HiueZEyh5dNqmOawtEGOfMmP7n4XLcPzbYLjXm7Y4RgzKyumi4NubOIfeAQUvNOcGlLOMK96OjYtguRUmGpmaQ2N+5BQnx5dNsoRNlalGruJTeNzX9CZSRNam19CbL78a6TiQdKga1b9OtFoww1WwEgq1jznPTfOFRhNgDXxpojetWODeGNnulFkqFXVumunGG48ngHTtuHQlN4vNVF2pKCJCma+tYa4bG6q0jTbIYhVVi1yRozTQwzWA6liyrLhrUe0BrWPsJt+oKrdbfzsrwu3ItnZvzJHQX6TmQM0PqOM5FuvKe6kiWuCeQY3gnzG3JAn00EaHE9P3lsJkWx4PoywiKULJ+JUFoP5WWz6HlZRgNkTrhrCwX5iP96Awxn1AzaBDVcz7Kfi+agejqyF4jPDMoZmVQl6B4CeZDVQbXNpJ8i85j4cDZdKCms7r17g9AD2pE2MuRINb+bKooik3HR7ELAJiD0YYaAQAgDZxtDtS0jl0gPtAdiBAAAAAAAAAAAADz8A/a3KzkVZoCpAAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.447058823529412,null,"tmap402","data2"]},{"method":"addLegend","args":[{"colors":["#E3EEF8","#BFD8EC","#7FB9DA","#4090C5","#1664AB"],"labels":["0.0000 to 0.0002","0.0002 to 0.0004","0.0004 to 0.0006","0.0006 to 0.0008","0.0008 to 0.0010"],"na_color":null,"na_label":"NA","opacity":0.447058823529412,"position":"topright","type":"unknown","title":"Airbnb Listings 2019","extra":null,"layerId":"legend402","className":"info legend data2","group":"data2"}]},{"method":"addLayersControl","args":[[],["data1","data2"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Spatial patterns revealed by the kernel density map above:</strong></p>
<ul>
<li>Shades of blue represent Airbnb listing in 2019 while shades of red represent Tourism.</li>
<li>Similar to the tmap of Airbnb Listings 2019 against Hotels, it can also be observed that the South-East region of Singapore has a high number of tourist attraction and is therefore dense since the red is darker in this region.</li>
<li>However, for tourism, it can be seen that it is slightly more concentrated in the middle as compared to hotels which is slightly more spread out.</li>
</ul>
<p><br></p>
<h5 id="plot-airbnb-listings-2019-against-mrt-services">7.1.1.3.3 Plot Airbnb Listings 2019 against MRT services</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>oms</span><span class='op'>(</span><span class='va'>kde_mrt_ppl_raster</span>, <span class='va'>kde_listings_2019_ppl_raster</span>, <span class='st'>"MRT"</span>, <span class='st'>"Airbnb Listings 2019"</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-7b430a5b9989d3ab616f" style="width:624px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7b430a5b9989d3ab616f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAGh0lEQVR4nO2dPW4cNxTHuYtV6yJp1QYQkMJCusDF+gA+gS7gM+gEOoMuoBPoAFERpDOUIoCAtGqTIq2EnRT2yFwuv/ke+Uj+f4AKrUYzXPI3j5/D2SiglFLq8Py0uP62Pb/Y1EzLbCBzlVtAXb7D89MCGXmYOlN90S8EhKRjyowskc8EMpazbZ2A2lAKCGiY6i7mEhDRsAyxmUfVEagZ+SBjHqIyLSRMaiG3qnohYxpi2oTUwkDAfhAhYaww1Mdx0fr6vdH0rqUoLHNAufR8FCAaptEss6QIwwEkTKNJdTyygEqN//1CpH7/anfsTAVji4SYe3bDnikzyafUqYAxiyNSWc85itSsX2I2AVe25xebmO+eI5HtvL3LKGKIZjRiBDw8PqjX+1uSm/Tw/LRw3/Cc54eElXBFq5frq+Xl+uqtgP/59edl/aG6NpWkXCLuOE4KTtEL8PD4oJRSavfp85uYLulerq+Ws5u7t+N846Lm72azgKN9SgGLhLO2BVPRI+B/v/158vdQNFzlceV3L+smEQkrskZAHZt8Jq/3t4seNU0kzhqlQC5hj5nQguX3UyFtnN3cbV6u1bJ2YnwyxtC66rVBmiAI6EaPgrqAoUj47uN7pbcJfVFRHxDvaSgH1XEFbNWwUnECKnUsXkoklCqdCSTshLU63l7unXLpn/cioFKDSOiKNNvLfeWU0LBGQBejzUN32yZ0ieeipZBmWl1tQpt8mw9f021LP+XjDi2l7jISpgooGV/UWwV0QbmQoWV07VJCG7Yhj1AhSsVMd2kUlz5qQTZ33PKLxoy5tYyepkS+myNHQN/ccEq51FgIYaM4Ekq/y6Swvdwf3QgxUTo1AvZaFsNUxyPRuldfu304jYStC1ZPQw9DSjVFLLpIq/BvK0SzXUjduKdm/Q7S0rVSMxIWP+fQitiOhtRC7hEuMbtdWb293EOwynAFniyzW0dBkx7aWCNBHRGHkFCpYxEhXz0ohOxiqzUgC+pIOM0QDQe2ZoA5KK1/XiMtPdYC0UYjCp4iZSVPbempI2G3vePW5MxFHx4ful8BxDFMAwkToRCphog9yQ4JGzFCVKQCbcJEOMUpaceZ6eJoE3LNmESdFAJ+hzt6Se7dQkIB1K4+JQmJbUAEMGv7rcZqmqCEM0bBWYUzqbWcC5HwGxDvmNCOX/oxpUwtIZV4oQW1qUhoC/r2sqGuHZ0SjlwNc8ln+zxVyBoCxu6pXYvoSCgt4blwC2g7ruXzzyVVZsyeNxQkVcdc4Th0TarrpT4SEHt8aCuPWCijYEiU0Ksumj9jErO3cakYply2TKGWPkYqmwg5ewvqMnI8Y6xUXztv+cjumJREqPV/TclMKUfbfcpGqnwj5oeI3rHvNVy1qv5UGdYo+OXvf48+/+WnH8ivOaJ4OkkSmrtA5Uii/2/K8XoaRugkxQg4unwrJxLmSkWxR3LM8TESO9u0jZbex1xnFuFsZK0nDAm3Pb/YUG7gyAmXgGc3dxt9w3Prtb/l08wCKmWJhFxVnW8IwNYxsR1HQe3ZCFfPeHbxdLJXVruEcXUyzON8v5dSs4BtHZEf//jr5PoSpuKkchQJqSNg6Hwx293GDNPYJOfuvLz7+P6th2yKqL8ubPfp8+b1/nb4oaYSWJ4x8e34WWPWRVLPOfRKMGDMmIQKL+ZuzpltSRHTlQb29/06duC3zZqYsyWQ0M9OKcJpsczzUFzfVf1yv3xQr5ZBHsFOhE5Mp4Oa0ByzC19bMvtm8byPRKn1ZYhf24Oh4RnwnS4k5Dx/avp9IkK8PKrNHYfafa2m4lKua94Qr/e3y+bDPnptIbATHdlKqrbQ2jXfMa2GNmydJ1ezgOpdxLPilIN62i1GxJzrUmPLA6lpHQVr75gjc2Mim7RCNdMsafxxJKxzx7UTIUk+WxuxpIYAYZouapVaoL7OSo1FFrNxktklGZrby5SO1PcEj8LJ3DHaPaA2pAsYRo0KtZ6/nZXud2rVIzfn+3q510DOjLMBTt02pCy00EAyxzUBH91HwtSeLJBHFQk5lu/rjxJIiXiQPg+nhJztKw5sIq5RstoD9EJuht5gaRPOiv5gPvIvHhHbgPQMOkTl7EbYUqM1kK6M5GeEZwbVLA/iMhQ3wXyIKuDSTpJtf0PfeRDZZCBmsLr27g9ADmIklPIsCajPUFWRbzk+ql0AwBz0NtUIAABhENnmQEzv2ATygeZAQgAAAAAAAAAAAMzD/3FgaGAj3aoLAAAAAElFTkSuQmCC",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","data1"]},{"method":"addLegend","args":[{"colors":["#FEE4D8","#FCB499","#FB795A","#ED392B","#BB1419"],"labels":["0.0000000 to 0.0000005","0.0000005 to 0.0000010","0.0000010 to 0.0000015","0.0000015 to 0.0000020","0.0000020 to 0.0000025"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"MRT","extra":null,"layerId":"legend401","className":"info legend data1","group":"data1"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFXElEQVR4nO2dvU4cMRSFvYiCggoJOpSGhqcgr5anSJM3yAukJHWqVFGkbQjdRtpqCzpSREaDxz/X9r329fh8EhKwsx6Pfeb4394ZYIwx5vn48hr67PbqYtcyLrOBxDVhAS7F93x8eYUYZZg6UWPulwKC5GPKhKwRnwvEWM9Z7wi0hlOAgIep3mIpAcIN61CbeFwNgZbOBzGWoSrRUoLJzeReRS/EmIeaOiG3YCDAcVAhQqpguK+Tovf9R6PrW8uRWW6Hcm14HMAN8+iWWFoEIwFEmEeX4njLAjRm+8+XIvf5m72xM2WMzwkx9hxGPFFmEp8xawFSJkfkYsPciqhFH2I2AVpury52lGcvEZEv3NHFqKKLZmu07kp6Pr68Sr/wkuFDhI0IuZUrIPs3Z6ZzhSclRBTHHUn1cdpiPSbgVPhc1QLJeqiICCE+XlIZX5veveuUEOEgUIVSkvabEyEEyItbpNa6Ym/B+WCNEAQoA3XB1fKzkbpyzntHAKRZiitHSFpF5wInHJBRxEUF/YQDsrWXHU44MJzLHXq6K5xwYDhHVnoaCBomE6C9hGKzYO0POgOheYwc4Ugy1Lpe0IbWIkSdEKxobSwQIfDSUohVtouieLu0LJKr1zmAeZASJopjQEbVzGq44NxwOyJECKrgEOQQW60BXXA7IeqEoDtkEcIFgRRwQpCFRDcNRAi6AxGC7kCEgEzXERM0SoAkcEJAQnJCA0RYyf5w6h0FUW6vLnbSM2rIuzEBP64I724uO8WEn1bTubDQiYHHp6MxxpiPH646x4SP2HYi7jW1wAkZ2LIbLnGFySXCoBNCfPlYRwyJcCnWx6fjyjlbiZe6eWYryMWxtohr5Puvv8aY/8WyK6gvP/68u+7h/rpJnGrcKvTdrrNoWrSUfPdseb8S7m4uzd3N5ZuwrCNa9oeT+fz159vfD/fXb0Jd/nCSyiv7eei67mtMKGdvcGxRG9v8MbXXnhaWRawV0v5wWonK979aRnhBKRS3jmuKZ3dDcBuOK0qNpyBZ0VHqfUu4BKgtPThQ0UUTO4ZLswtaUg2SWrYovCXFRxNQr419N3VfjeJ0i1/J7pmti8+ycsJSUXHskUy5nrJtroRA3Todt/vNIjgfxbs4xXaAKj2zjSsjWrhkqqHRcsRhdFZOKFXUxYpaX8PEd50mYi1hClqfqwfFs2hCgqHskedew50hrTI41BKGwPJ454TcDpgKj1J8U4ppn8glHH3pevvDyXz69ts83F+vnHCEriZNiMwnjO2l3KIDWipsV2x25GN/OAVdEQJMQzql3JJzGmTsu6HiueZEyh5dNqmOawtEGOfMmP7n4XLcPzbYLjXm7Y4RgzKyumi4NubOIfeAQUvNOcGlLOMK96OjYtguRUmGpmaQ2N+5BQnx5dNsoRNlalGruJTeNzX9CZSRNam19CbL78a6TiQdKga1b9OtFoww1WwEgq1jznPTfOFRhNgDXxpojetWODeGNnulFkqFXVumunGG48ngHTtuHQlN4vNVF2pKCJCma+tYa4bG6q0jTbIYhVVi1yRozTQwzWA6liyrLhrUe0BrWPsJt+oKrdbfzsrwu3ItnZvzJHQX6TmQM0PqOM5FuvKe6kiWuCeQY3gnzG3JAn00EaHE9P3lsJkWx4PoywiKULJ+JUFoP5WWz6HlZRgNkTrhrCwX5iP96Awxn1AzaBDVcz7Kfi+agejqyF4jPDMoZmVQl6B4CeZDVQbXNpJ8i85j4cDZdKCms7r17g9AD2pE2MuRINb+bKooik3HR7ELAJiD0YYaAQAgDZxtDtS0jl0gPtAdiBAAAAAAAAAAAADz8A/a3KzkVZoCpAAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.447058823529412,null,"tmap402","data2"]},{"method":"addLegend","args":[{"colors":["#E3EEF8","#BFD8EC","#7FB9DA","#4090C5","#1664AB"],"labels":["0.0000 to 0.0002","0.0002 to 0.0004","0.0004 to 0.0006","0.0006 to 0.0008","0.0008 to 0.0010"],"na_color":null,"na_label":"NA","opacity":0.447058823529412,"position":"topright","type":"unknown","title":"Airbnb Listings 2019","extra":null,"layerId":"legend402","className":"info legend data2","group":"data2"}]},{"method":"addLayersControl","args":[[],["data1","data2"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Spatial patterns revealed by the kernel density map above:</strong></p>
<ul>
<li>Shades of blue represent Airbnb listings in 2019 while shades of red represent MRT services.</li>
<li>Mrt services are dense not only in the same area as the Airbnb listings in 2019, it is also dense in the North-East and North-West region of Singapore.</li>
<li>This can be observed from the red spots above.</li>
<li>In the South-East region of Singapore, it can be observed that MRT services are not as concentrated as compared to tourism and hotels. MRT services are slightly more spread out within the South-East region of Singapore.</li>
<li>MRT services is in fact more spread out than hotels within the South-East region of Singapore.</li>
</ul>
<p><br></p>
<p><strong>Advantage of kernel density map over point map:</strong></p>
<ul>
<li><p>Point map shows all of the occurrences of the point events. It is tough to tell the dense areas from a point map.</p></li>
<li><p>Kernel density maps on the other hand can highlight areas that have high number of the point events. With the help of the shades of colours, the darker it is, the higher the occurrences of these point events. Vice versa, with kernel density maps, areas with lesser point events would not be shown. This means that less prominent spots would not be highlighted in the kernel density map.</p></li>
<li><p>An advantage of kernel density maps is hence the ability to highlight areas that are dense in the point events (high number of occurrences).</p></li>
</ul>
<p><strong>Conclusion for Section A’s Exploratory Spatial Data Analysis:</strong></p>
<ul>
<li>With kernel density maps however, even though we do see that the distribution of Airbnb listings with hotels, tourist attractions and MRT services are in the same region (with a little variation of the MRT services), we cannot conclude for sure that the distribution of Airbnb listings are affected by the above-mentioned location factors.</li>
<li>Hence, we need to employ <strong>Second-order Spatial Point Patterns Analysis</strong> to draw statistical conclusions.</li>
</ul>
<h2 id="second-order-spatial-point-patterns-analysis">7.2 Second Order Spatial Point Patterns Analysis</h2>
<p>A second order spatial point patterns analysis describes the covariance or correlation between values of a spatial point pattern at different regions in space. There are 4 functions available for us to use, namely Cross G-Function, Cross F-Function, Cross K-Function and Cross L-Function. For the purpose of this study, the <strong>Cross L-Function</strong> will be used.</p>
<p>Cross F-Function will <strong>not</strong> be used as it selects a sample of locations within the study region at random. This means that not all point events will be used for the computation.</p>
<p>Cross K-Function will <strong>not</strong> be used as we need to look at the curve which might be a little ambiguous. Instead, <strong>Cross L-Function will be used</strong> as it standardizes the curve.</p>
<p>Because of the reasons listed above, <strong>Cross L-Function</strong> would be used.</p>
<h3 id="prepare-and-visualise-subzones">7.2.1 Prepare and visualise subzones</h3>
<ul>
<li><p>Before diving into the computation of the Cross Functions, we first select a sub zone as it is computationally expensive to perform Second Order Spatial Point Patterns Analysis on the entire Singapore.</p></li>
<li><p>Sub zone “DOWNTOWN CORE” will be selected since based on the Exploratory Spatial Data Analysis, most point events for all are clustered around this sub zone.</p></li>
<li><p>The code chunk below:</p>
<ul>
<li>Specifies the study area to be extracted, which is DOWNTOWN CORE</li>
<li>To only take the non NA values</li>
<li>Plot the study area using the mpsz data sets to visualise the selected study area.</li>
</ul></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz_sf</span><span class='op'>$</span><span class='va'>STUDY_AREA</span><span class='op'>[</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>'DOWNTOWN CORE'</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Y"</span> 

<span class='va'>mpsz_sf</span><span class='op'>$</span><span class='va'>STUDY_AREA</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>$</span><span class='va'>STUDY_AREA</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>'N'</span>

<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_sf</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>'STUDY_AREA'</span>,
          palette <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'grey'</span>, <span class='st'>'lightblue'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>'gray28'</span>, lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>tm_layout</span><span class='op'>(</span>legend.show <span class='op'>=</span> <span class='cn'>FALSE</span>,
              frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<h3 id="extract-selected-study-areas">7.2.2 Extract selected study areas</h3>
<h4 id="create-owin-for-each-subzones">7.2.2.1 Create owin for each subzones</h4>
<ul>
<li>Create function to create owin objects for each sub zones.</li>
<li>Apply the function created on the selected study area.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>convert_owin</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>sz</span>, <span class='va'>plan_area</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>sz</span><span class='op'>[</span><span class='va'>sz</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='va'>plan_area</span>,<span class='op'>]</span> <span class='op'>%&gt;%</span>
    <span class='fu'>as</span><span class='op'>(</span><span class='st'>'Spatial'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>as</span><span class='op'>(</span><span class='st'>'SpatialPolygons'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>as</span><span class='op'>(</span><span class='st'>'owin'</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>downtowncore_owin</span> <span class='op'>&lt;-</span> <span class='fu'>convert_owin</span><span class='op'>(</span><span class='va'>mpsz_sf</span>, <span class='st'>"DOWNTOWN CORE"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="combine-spatialpoints-objects-with-owin-objects">7.2.2.2 Combine SpatialPoints objects with owin objects</h4>
<ul>
<li>Combine SpatialPoints object i.e. Airbnb listings in 2019, hotels, tourism and MRT with the downtown core owin object.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>downtowncore_2019_ppp</span> <span class='op'>&lt;-</span> <span class='va'>listings_2019_ppp</span><span class='op'>[</span><span class='va'>downtowncore_owin</span><span class='op'>]</span>
<span class='va'>downtowncore_hotels_ppp</span> <span class='op'>&lt;-</span> <span class='va'>hotels_ppp</span><span class='op'>[</span><span class='va'>downtowncore_owin</span><span class='op'>]</span>
<span class='va'>downtowncore_tourisms_ppp</span> <span class='op'>&lt;-</span> <span class='va'>tourisms_ppp</span><span class='op'>[</span><span class='va'>downtowncore_owin</span><span class='op'>]</span>
<span class='va'>downtowncore_mrt_ppp</span> <span class='op'>&lt;-</span> <span class='va'>mrt_ppp</span><span class='op'>[</span><span class='va'>downtowncore_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<h4 id="combine-the-ppp-objects">7.2.2.3 Combine the ppp objects</h4>
<ul>
<li><em>superimpose()</em> of <strong>spatstat</strong> package to combine ppp objects.</li>
<li><em>=</em> sign is to combine such that the ppp objects are marked.</li>
<li>This is necessary for plotting the Cross Functions.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_downtowncore_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>superimpose</span><span class='op'>(</span>dc_2019_mark<span class='op'>=</span><span class='va'>downtowncore_2019_ppp</span>,
                                    dc_hotels_mark<span class='op'>=</span><span class='va'>downtowncore_hotels_ppp</span>,
                                    dc_tourisms_mark<span class='op'>=</span><span class='va'>downtowncore_tourisms_ppp</span>,
                                    dc_mrt_mark<span class='op'>=</span><span class='va'>downtowncore_mrt_ppp</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="multi-type-point-patterns-analysis-cross-l-function">7.2.3 Multi-type Point Patterns Analysis: Cross L-Function</h3>
<h4 id="compute-cross-l-function-estimation">7.2.3.1 Compute Cross L-Function Estimation</h4>
<ul>
<li><p>Create a function for computing Cross L-Function Estimation</p>
<ul>
<li><em>Lcross()</em> of <strong>spatstat</strong> package is used to compute the Cross L-Function estimation.</li>
<li><em>plot()</em> to visualise the relationship.</li>
</ul></li>
<li><p>Finally, the function created is being called to plot the graphs</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>lcross</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>i</span>, <span class='va'>j</span>, <span class='va'>title</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>compute</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>i</span>, <span class='va'>j</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>compute</span>, <span class='va'>.</span> <span class='op'>-</span> <span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"d"</span>, ylab<span class='op'>=</span><span class='st'>"L(d)-r"</span>, main<span class='op'>=</span><span class='va'>title</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>lcross</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>all_downtowncore_ppp</span>, i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_hotels_mark"</span>, title<span class='op'>=</span><span class='st'>"Listings 2019 vs Hotels Lcross"</span><span class='op'>)</span>
<span class='fu'>lcross</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>all_downtowncore_ppp</span>, i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_tourisms_mark"</span>, title<span class='op'>=</span><span class='st'>"Listings 2019 vs Tourisms Lcross"</span><span class='op'>)</span>
<span class='fu'>lcross</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>all_downtowncore_ppp</span>, i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_mrt_mark"</span>, title<span class='op'>=</span><span class='st'>"Listings 2019 vs MRT Lcross"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-39-1.png" width="1152" /></p>
</div>
<p>Results above show that:</p>
<ul>
<li>There is a sign that the marked spatial point events are not spatially independent at certain distances for all plots.</li>
<li>However, a hypothesis test is still required to confirm this observation statistically.</li>
</ul>
<h4 id="perform-csr-test-on-cross-l-function">7.2.3.2 Perform CSR test on Cross L-Function</h4>
<ul>
<li><p>The hypothesis and test are as follows:</p>
<ul>
<li>Ho = The distribution of Airbnb listings in 2019 and Hotels/Tourist Attractions/MRT services are spatially independent.</li>
<li>H1 = The distribution of Airbnb listings in 2019 and Hotels/Tourist Attractions/MRT services are <strong>NOT</strong> spatially independent.</li>
</ul></li>
<li><p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.1 (i.e. at 90% confident interval). (this applies to all of the above points)</p></li>
</ul>
<h4 id="monte-carlo-test-with-cross-l-function">7.2.3.3 Monte Carlo test with Cross L-Function</h4>
<ul>
<li><em>envelope()</em> of <strong>spatstat</strong> package is used to perform CSR test</li>
<li>A total of 100 simulations will be ran. Using <strong>spatstat</strong> package, the end is always 1 less as the 1st simulation is 0 (and not 1), hence in the argument <em>nsim</em>, it is defined as 99 and not 100.</li>
<li>A global <em>set.seed()</em> is used to ensure that the same output is computed each time the code is being ran. (<em>set.seed(1234)</em> is being used and it is placed at the top of the .RMD file, which cannot be seen here.)</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>dc_listings_2019_hotels_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>all_downtowncore_ppp</span>, <span class='va'>Lcross</span>,
                                               i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_hotels_mark"</span>,
                                              correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>99</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70,
71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.

Done.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dc_listings_2019_tourisms_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>all_downtowncore_ppp</span>, <span class='va'>Lcross</span>,
                                               i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_tourisms_mark"</span>,
                                              correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>99</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70,
71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.

Done.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dc_listings_2019_mrt_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>all_downtowncore_ppp</span>, <span class='va'>Lcross</span>,
                                               i<span class='op'>=</span><span class='st'>"dc_2019_mark"</span>, j<span class='op'>=</span><span class='st'>"dc_mrt_mark"</span>,
                                              correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>99</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70,
71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.

Done.</code></pre>
</div>
<h4 id="plot-cross-l-function">7.2.3.4 Plot Cross L-Function</h4>
<ul>
<li>plot() is used to plot the simulated Cross L-Function</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dc_listings_2019_hotels_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dc_listings_2019_tourisms_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dc_listings_2019_mrt_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-41-1.png" width="1152" /></p>
</div>
<p>Results above show that:</p>
<ul>
<li><p>Red line represents the theoretical curve, the black line represents the observed curve and the grey shaded area represents the envelope derived based on the simulation.</p></li>
<li><p>For Airbnb listings 2019 vs Hotels</p>
<ul>
<li>From about <strong>50 to 150m</strong>, it can be observed that the black line is not only above the red line, it is also above the envelope. This shows signs of significant cluster pattern from the 50 to 150m mark. Also, since it is above the envelope, we have enough statistical evidence to <strong>reject the null hypothesis</strong> at 90% confidence interval.</li>
<li>After the <strong>150m mark</strong>, the black line is below the red line and this shows signs of regular pattern. However, we can only say that it shows sign of significant regular pattern after the 150m mark as this is the part where the black line is below the envelope. Since it is below the envelope, we have enough statistical evidence to <strong>reject the null hypothesis</strong> at 90% confidence interval.</li>
<li>To summarise, for both distances i.e.50 to 150m and after the 150m mark, are NOT spatially independent but from <strong>50 to 150m</strong>, it has <strong>significant cluster pattern</strong> while after the <strong>150m mark</strong>, it has <strong>significant regular pattern</strong>.</li>
</ul></li>
<li><p>For Airbnb listings 2019 vs Tourism</p>
<ul>
<li>The black line is below the red line which shows signs of regular pattern. But it is only significant for ditances <strong>after 250m</strong>.</li>
<li>Hence, only for distances <strong>after 250m</strong>, we have enough statistical evidence to <strong>reject the null hypothesis</strong> at 90% confidence interval. We can hence infer that it is NOT spatially independent and for certain distances and has <strong>significant regular patterns.</strong></li>
</ul></li>
<li><p>For Airbnb listings 2019 vs MRT</p>
<ul>
<li>The black line is above the red line which shows signs of cluster pattern. But it is only significant at from <strong>160m to 220m</strong>.</li>
<li>Hence, only from the distance of <strong>160m to 220m</strong>, we have have enough statistical evidence and we <strong>will reject the null hypothesis</strong> at 90% confidence interval. We can hence infer that it is NOT spatially independent for certain distances.</li>
</ul></li>
</ul>
<h1 id="section-b-impact-of-covid-19">8 Section B: Impact of COVID-19</h1>
<p>This section is to analyse the impact of COVID-19 on Airbnb business in Singapore by comparing Airbnb listings data on June 2019 and June 2021. To determine the objective, we will first perform and plot <strong>Kernel Density Estimation maps</strong> by room type then confirm the insights found by using <strong>Second-Order Spatial Point Patterns Analysis</strong> to draw statistical conclusions.</p>
<h2 id="exploratory-spatial-data-analysis-1">8.1 Exploratory Spatial Data Analysis</h2>
<h3 id="kernel-density-estimation-1">8.1.1 Kernel Density Estimation</h3>
<ul>
<li><em>unique()</em> to find out the categories of room types in Airbnb Listings in 2019 &amp; 2021.</li>
</ul>
<h4 id="retrieve-categories-of-room_types">8.1.1.1 Retrieve categories of room_types</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>listings_2019_sf</span><span class='op'>$</span><span class='va'>room_type</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Private room&quot;    &quot;Entire home/apt&quot; &quot;Shared room&quot;    </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>listings_2021_sf</span><span class='op'>$</span><span class='va'>room_type</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Private room&quot;    &quot;Entire home/apt&quot; &quot;Shared room&quot;    
[4] &quot;Hotel room&quot;     </code></pre>
</div>
<p>From the results above,</p>
<ul>
<li>There are 3 categories in Airbnb Listings in 2019, namely Private room, Entire home/apt and Shared room</li>
<li>There are 3 categories in Airbnb Listings in 2021, namely Private room, Entire home/apt, Shared room and Hotel room.</li>
</ul>
<h4 id="subset-categories-into-different-ppp-objects">8.1.1.2 Subset categories into different ppp objects</h4>
<ul>
<li><em>subset()</em> to retrieve the ppp objects of the different categories for both Airbnb Listings in 2019 and 2020.</li>
<li>This is for calculating and plotting KDE maps in later part of the section.</li>
<li>Since “Hotel Room” is not available in the Airbnb listings in 2021, it will be excluded from the analysis.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp_pr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>, <span class='va'>listings_2019_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Private room"</span><span class='op'>)</span>
<span class='va'>listings_2019_ppp_ea</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>, <span class='va'>listings_2019_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Entire home/apt"</span><span class='op'>)</span>
<span class='va'>listings_2019_ppp_sr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2019_ppp</span>, <span class='va'>listings_2019_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Shared room"</span><span class='op'>)</span>

<span class='va'>listings_2021_ppp_pr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp</span>, <span class='va'>listings_2021_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Private room"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp_ea</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp</span>, <span class='va'>listings_2021_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Entire home/apt"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp_sr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>listings_2021_ppp</span>, <span class='va'>listings_2021_sf</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>==</span> <span class='st'>"Shared room"</span><span class='op'>)</span>
<span class='co'># listings_2021_ppp_hr &lt;- subset(listings_2021_ppp, listings_2021_sf$room_type == "Hotel room")</span>
</code></pre>
</div>
</div>
<h4 id="re-scale-kde-values-1">8.1.1.3 Re-scale KDE Values</h4>
<ul>
<li>However, since the default unit of measurement of SVY21 is in meter, we have to convert the KDE values to km so that the values would not be too small to look for useful insights.</li>
<li><em>rescale()</em> is used to convert the KDE values from meter to kilometer.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>listings_2019_ppp_pr.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2019_ppp_pr</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>listings_2019_ppp_ea.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2019_ppp_ea</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>listings_2019_ppp_sr.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2019_ppp_sr</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>

<span class='va'>listings_2021_ppp_pr.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2021_ppp_pr</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp_ea.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2021_ppp_ea</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='va'>listings_2021_ppp_sr.km</span> <span class='op'>&lt;-</span> <span class='fu'>rescale</span><span class='op'>(</span><span class='va'>listings_2021_ppp_sr</span>, <span class='fl'>1000</span>, <span class='st'>"km"</span><span class='op'>)</span>
<span class='co'># listings_2021_ppp_hr.km &lt;- rescale(listings_2021_ppp_hr, 1000, "km")</span>
</code></pre>
</div>
</div>
<h4 id="plot-kde-maps-using-automatic-bandwidth-methods-ppl">8.1.1.4 Plot KDE maps using automatic bandwidth methods (ppl)</h4>
<ul>
<li>Explanation for this section is similar to 7.1.1.1</li>
</ul>
<h5 id="bw.ppl-1"><em>bw.ppl</em></h5>
<h6 id="airbnb-listings-2019">Airbnb Listings 2019</h6>
<ul>
<li>The function used was created in Section A, to plot KDE maps using the bandwidth <em>bw.ppl()</em></li>
<li>par() is used to arrange the maps in a side-by-side manner</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>listings_2019_ppp_pr.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"listings 2019 private room bw.ppl"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>listings_2019_ppp_ea.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"listings 2019 entire home/apt  bw.ppl"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>kde_ppl</span><span class='op'>(</span><span class='va'>listings_2019_ppp_sr.km</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"listings 2019 shared room bw.ppl"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-45-1.png" width="960" /></p>
</div>
<p>Results above show that:</p>
<ul>
<li>There is a concentrated area for Shared Rooms and a few less concentrated spots for Private Room and Entire room/apt.</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
